<!-- This entire file was generated by meta.js at hw3zdcege0x3r50ua3mq -->
<!-- Any changes to this file will be overwritten when the application is regenerated -->
<!-- Make your changes in the generator meta.js or in the data dictionary metadata.json -->
<h1>Edit Our Contacts</h1>

<hr />

<h2>Edit Our Contact</h2>
<div class="formWrapper">
  <form id="oContactEditForm" action="/api/oContact" method="PUT">
    <input type="hidden" name="_method" value="PUT"/>
    <div class="formError"></div>
    <div class="formSuccess">Your Changes Have Been Saved</div>
    <div class="inputWrapper">
      <div class="inputLabel">oContactId</div>
      <input class="disabled" type="text" name="oContactId" value="{selected.oContactId}" disabled/>
    </div>
    <div class="inputWrapper">
      <div class="inputLabel">First Name</div>
      <input class="firstNameInput" name="firstName" type="text" placeholder="Enter a First Name"/>
    </div>
    <div class="inputWrapper">
      <div class="inputLabel">Last Name</div>
      <input class="lastNameInput" name="lastName" type="text" placeholder="Enter a Last Name"/>
    </div>
    <div class="inputWrapper">
      <div class="inputLabel">Email</div>
      <input class="emailInput" name="email" type="text" placeholder="Enter an Email Address with @"/>
    </div>
    <div class="objectLabel">Phone Information</div>
    <div class="objectWrapper groupWrapper">
      <div class="objectWrapper elementWrapper">
        <div class="inputWrapper">
          <div class="inputLabel">Phone Type</div>
          <select class="resetElement phone_properties_phone0_properties_phoneTypeInput" name="phone_properties_phone0_properties_phoneType">
            <option value="" style="display: list-item;">Select the Phone Type</option>
            <option value="Mobile" style="display: list-item;">Mobile Phone</option>
            <option value="Home" style="display: list-item;">Home Phone</option>
            <option value="Office" style="display: list-item;">Office Phone</option>
            <option value="Answering Service" style="display: list-item;">Answering Service</option>
          </select>
        </div>
        <div class="inputWrapper">
          <div class="inputLabel">Phone</div>
          <input class="resetElement phone_properties_phone0_properties_phoneInput" name="phone_properties_phone0_properties_phone" type="text" placeholder="Enter a Phone Number"/>
        </div>
        <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
        <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
        <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
      </div>
      <button type="button" class="addNewObjectButton">Add New</button>
    </div>
    <div class="objectLabel">Address Information</div>
    <div class="objectWrapper groupWrapper">
      <div class="objectWrapper elementWrapper">
        <div class="inputWrapper">
          <div class="inputLabel">Address Type</div>
          <select class="resetElement address_properties_address0_properties_addressTypeInput" name="address_properties_address0_properties_addressType" placeholder="Enter an Address Type">
            <option value="" style="display: list-item;">Select the Address Type</option>
            <option value="Home Address" style="display: list-item;">Home Address</option>
            <option value="Work Address" style="display: list-item;">Work Address</option>
            <option value="Billing Address" style="display: list-item;">Billing Address</option>
            <option value="Shipping Address" style="display: list-item;">Shipping Address</option>
          </select>
        </div>
        <div class="inputWrapper">
          <div class="inputLabel">Street 1</div>
          <input class="resetElement address_properties_address0_properties_streetOneInput" name="address_properties_address0_properties_streetOne" type="text" placeholder="Enter a Street Address"/>
        </div>
        <div class="inputWrapper">
          <div class="inputLabel">Street 2</div>
          <input class="resetElement address_properties_address0_properties_streetTwoInput" name="address_properties_address0_properties_streetTwo" type="text" placeholder="Optional Field"/>
        </div>
        <div class="inputWrapper">
          <div class="inputLabel">City</div>
          <input class="resetElement address_properties_address0_properties_cityInput" name="address_properties_address0_properties_city" type="text" placeholder="Enter a City"/>
        </div>
        <div class="inputWrapper">
          <div class="inputLabel">State</div>
          <input class="resetElement address_properties_address0_properties_stateInput" name="address_properties_address0_properties_state" type="text" placeholder="Enter a State"/>
        </div>
        <div class="inputWrapper">
          <div class="inputLabel">Zip Code</div>
          <input class="resetElement address_properties_address0_properties_zipInput" name="address_properties_address0_properties_zip" type="text" placeholder="Enter a Zip Code"/>
        </div>
        <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
        <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
        <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
      </div>
      <button type="button" class="addNewObjectButton">Add New</button>
    </div>
    <div class="inputWrapper">
      <div class="inputLabel">Time Stamp</div>
      <input class="timeStampInput" type="text" name="timeStamp" disabled/>
    </div>
    <div class="inputWrapper ctaWrapper smallTopMargin">
      <button type="submit" class="cta green">Save Changes</button>
    </div>
  </form>
</div>

<hr />
<h2>Delete Our Contact</h2>
<div class="formWrapper">
  <form id="oContactDeleteForm" action="/api/oContact" method="PUT">
    <input type="hidden" name="_method" value="PUT"/>
    <div class="formError"></div>
    <div class="warning">Warning: This action cannot be undone. <br>
      Don't click this button on accident!</div>
      <input class="hiddenInput"  type="hidden" name="oContactId" value="{selected.oContactId}"/>
      <input class="hiddenInput"  type="hidden" name="deleted" value="true"/>
    <div class="inputWrapper ctaWrapper smallTopMargin">
      <button type="submit" class="cta red">Delete</button>
    </div>
  </form>
</div>


<script>
/*
 * Frontend Logic for application
 *
 */

"use strict";

// Container for frontend application
var app = {};


// AJAX Client (for RESTful API)
// Create an empty object to contain the client.
app.client = {}

// Define interface function for making API calls.
app.client.request = function(headers,path,method,queryStringObject,payload,callback)
{
  // Set defaults
  headers = typeof(headers) == 'object' && headers !== null ? headers : {};
  path = typeof(path) == 'string' ? path : '/';
  method = typeof(method) == 'string' && ['POST','GET','PUT','DELETE'].indexOf(method.toUpperCase()) > -1 ? method.toUpperCase() : 'GET';
  queryStringObject = typeof(queryStringObject) == 'object' && queryStringObject !== null ? queryStringObject : {};
  payload = typeof(payload) == 'object' && payload !== null ? payload : {};
  callback = typeof(callback) == 'function' ? callback : false;

  // For each query string parameter sent, add it to the path
  var requestUrl = path+'?';
  var counter = 0;
  for(var queryKey in queryStringObject)
  {
    if(queryStringObject.hasOwnProperty(queryKey))
    {
      counter++;

      // If at least one query string parameter has already been added, preprend new ones with an ampersand
      if(counter > 1)
      {
        requestUrl+='&';
      }

      // Add the key and value
      requestUrl+=queryKey+'='+queryStringObject[queryKey];
    }
  }

  // Form the http request as a JSON type
  var xhr = new XMLHttpRequest();
  xhr.open(method, requestUrl, true);
  xhr.setRequestHeader("Content-type", "application/json");

  // For each header sent, add it to the request
  for(var headerKey in headers)
  {
     if(headers.hasOwnProperty(headerKey))
     {
       xhr.setRequestHeader(headerKey, headers[headerKey]);
     }
  }

  // If there is a current session token set, add that as a header
  // if(app.config.sessionToken)
  // {
  //   xhr.setRequestHeader("token", app.config.sessionToken.id);
  // }

  // When the request comes back, handle the response
  xhr.onreadystatechange = function()
  {
      if(xhr.readyState == XMLHttpRequest.DONE) 
      {
        var statusCode = xhr.status;
        var responseReturned = xhr.responseText;

        // Callback if requested
        if(callback)
        {
          try
          {
            var parsedResponse = JSON.parse(responseReturned);
            callback(statusCode,parsedResponse);
          } 
          catch(e)
          {
            callback(statusCode,false);
          }

        }
      }
  }

  // Send the payload as JSON
  var payloadString = JSON.stringify(payload);
  xhr.send(payloadString);

}; // End of: app.client.request = function(headers,path,method,queryStringObject,payload,callback){...}
// End of: Interface for making API calls




// Add a listener to the submit event of all forms in the DOM and bind the anonymous 
// function declared below to the listener using addEventListener.
// bindForms is called from app.init when the webpage is loaded but the anonymous 
// function declared using addEventListener only runs when the form is submitted.
// The function takes the submit event object (e) as the argument.
app.bindForms = function()
{
  // If the DOM contains the CSS selector "form"
  if(document.querySelector("form"))
  {

    // Create an interface to manipulate all the forms in the DOM.
    var allForms = document.querySelectorAll("form");

    // Add a listener to the submit event of every form in the DOM and bind the anonymous function declared here.
    for(var i = 0; i < allForms.length; i++)
    {
      // The following is what runs when the user submits the form.
      allForms[i].addEventListener("submit", function(e)
      {
        // Stop it from submitting
        e.preventDefault();

        // The key word "this" below refers to the html (more accurately the DOM) of the form being submitted.
        // The formId from the html (DOM) is used when loading the form with data.
        var formId = this.id;
        //path and method will determine which api handler will get called.
        var path = this.action;
        var method = this.method.toUpperCase();

        // Hide the error message (if it's currently shown due to a previous error)
        document.querySelector("#"+formId+" .formError").style.display = 'none';

        // Hide the success message (if it's currently shown)
        if(document.querySelector("#"+formId+" .formSuccess"))
        {
          document.querySelector("#"+formId+" .formSuccess").style.display = 'none';
        }


        // Create an empty payload object.
        var payload = {};

        // this.elements is an object containing the inputs and buttons defined in the html of the form being submitted.
        var elements = this.elements;

        // Load the payload object with the names and values of the elements in the form being submitted. 
        for(var i = 0; i < elements.length; i++)
        {
          if(elements[i].type !== 'submit')
          {
            // Determine class of element and set value accordingly.
            var classOfElement = typeof(elements[i].classList.value) == 'string' && elements[i].classList.value.length > 0 ? elements[i].classList.value : '';
            var valueOfElement = elements[i].type == 'checkbox' && classOfElement.indexOf('multiselect') == -1 ? elements[i].checked : classOfElement.indexOf('intval') == -1 ? elements[i].value : parseInt(elements[i].value);
            var elementIsChecked = elements[i].checked;

            // Override the method of the form if the input's name is _method
            var nameOfElement = elements[i].name;

            if(nameOfElement == '_method')
            {
              method = valueOfElement;
            } 
            else // nameOfElement was something other than '_method'
            {
              // Create a payload field named "method" if the elements name is actually httpmethod
              if(nameOfElement == 'httpmethod')
              {
                nameOfElement = 'method';
              }

              // Create an payload field named "id" if the elements name is actually uid
              if(nameOfElement == 'uid')
              {
                nameOfElement = 'id';
              }

              // If the element has the class "multiselect" add its value(s) as array elements
              if(classOfElement.indexOf('multiselect') > -1)
              {
                if(elementIsChecked)
                {
                  payload[nameOfElement] = typeof(payload[nameOfElement]) == 'object' && payload[nameOfElement] instanceof Array ? payload[nameOfElement] : [];
                  payload[nameOfElement].push(valueOfElement);
                }
              } 
              else // element was not of the class multiselect
              {
                payload[nameOfElement] = valueOfElement;
              }
            } // End of: nameOfElement was something other than '_method'
          } // End of: if(elements[i].type !== 'submit'){...}
        } // End of: for(var 1...
        // End of: Load the payload object with the names and values of the elements in the form.



        // If the method is DELETE, the payload should be a queryStringObject instead
        var queryStringObject = method == 'DELETE' ? payload : {};              

        // Call the API
        app.client.request(undefined,path,method,queryStringObject,payload,function(statusCode,responsePayload)
        {
          // Display an error on the form if needed
          if(statusCode !== 200)
          {
            // Try to get the error from the api, or set a default error message
            var error = typeof(responsePayload.Error) == 'string' ? responsePayload.Error : 'An error has occured, please try again';

            // Set the formError field with the error text
            document.querySelector("#"+formId+" .formError").innerHTML = error;

            // Show (unhide) the form error field on the form
            document.querySelector("#"+formId+" .formError").style.display = 'block';
            // }
          } 
          else // The submit was successful and we got a response back from the server.
          {
            // Send to form response processor
            app.formResponseProcessor(formId,payload,responsePayload);
          }

        }); // End of: app.client.request(undefined,path,method,queryStringObject,payload,function(statusCode,responsePayload){...}
      }); // End of: allForms[i].addEventListener("submit", function(e){...} What runs when users submit the form.
    } // End of: for(var i = 0; i < allForms.length; i++){...}
  } // End of: if(document.querySelector("form")){...}
}; // End of: app.bindForms = function(){...}
// End of: Bind the anonymous function defined above to the submit event of any forms in the DOM.




// Form submit post processor
// This is the last function called from the anonymous function defined in app.bindForms which 
// executes on a form's submit event.
// So this function defines what happens after a form has been sucessfully submitted.
app.formResponseProcessor = function(formId,requestPayload,responsePayload)
{
  // If the administrator just deleted a record then navigate back to the list page for this table.
  if(formId.slice(-10) === 'DeleteForm')
  {
    window.location = formId.slice(0, -10) + '/list';
  }

  // If the form has success message:
  if(document.querySelector("#"+formId+" .formSuccess"))
  {
    // Display the success Message
    document.querySelector("#"+formId+" .formSuccess").style.display = 'block';
  }

}; // End of: app.formResponseProcessor = function(formId,requestPayload,responsePayload){...}
// End of: Form submit post processor - processing after a sucessful form submit.




// Load the oContactEdit page with data from the server.
app.loadoContactEditPage = async function()
{
  // Get the published fields and the timeStamp.
  // Get oContactId
  // The template function inserts the oContactId into the html before serving it to the client.
  let oContactId = document.querySelector("form input[name=oContactId]").value;

  // Create a queryExpression with a key of oContactId and a value of the 
  // particular oContactId that the user clicked on in the list.
  let queryExpression = "?WHERE:;oContactId:;MatchesExactly:;" + oContactId + ":;";

  // Run the query defined below to get the published fields and the timeStamp for the oContactID.    
  let recordArray = await runQueryOnoContactId(queryExpression);

  // Get the record object from the array returned by the query.
  let recordObject = recordArray[0];

  let allowRenumbering = false;

  // Define the function that fires when the moveObjectUpButton is selected.
  function onClickBehaviorForMoveObjectUpButton (event)  
  {

    // Stop it from redirecting anywhere
    event.preventDefault();

    // Enable the moveObjectUpButton on the object coming down.
    let moveObjectUpButtonOnTheObjectComingDown = event.target.parentNode.previousElementSibling.querySelector(".moveObjectUpButton");
    moveObjectUpButtonOnTheObjectComingDown.classList.remove('disabled');
    moveObjectUpButtonOnTheObjectComingDown.removeAttribute("disabled");

    // Find out if we are on the bottom
    if(event.target.parentNode === event.target.parentNode.parentNode.querySelector(".elementWrapper:nth-last-child(2)"))
    {
      // The object coming down will not be able to go down anymore.
      // So no need for the moveObjectDownButton. Disable it. 
      let moveObjectDownButtonOnTheObjectComingDown = event.target.parentNode.previousElementSibling.querySelector(".moveObjectDownButton");      
      moveObjectDownButtonOnTheObjectComingDown.classList.add("disabled");
      moveObjectDownButtonOnTheObjectComingDown.setAttribute("disabled", "");
    }       

    // Since we are moving this elementWrapper up we need to be sure the moveObjectDownButton is enabled.
    // Need this in case it was sitting on the bottom where the down button is disabled.
    // Enable the moveObjectDownButton next to the target button
    let moveObjectDownButtonNextToTargetButton = event.target.parentNode.querySelector(".moveObjectDownButton")
    moveObjectDownButtonNextToTargetButton.classList.remove('disabled');
    moveObjectDownButtonNextToTargetButton.removeAttribute("disabled");
    
    // Move the object up
    if(event.target.parentNode.previousSibling)
    {
      event.target.parentNode.parentNode.insertBefore(event.target.parentNode, event.target.parentNode.previousElementSibling);
    }
     
    // Find out if we are at the top
    if(event.target.parentNode === event.target.parentNode.parentNode.firstElementChild)
    {
      // Can't move up anymore than this.
      // Disable the target moveObjectUpButton
      event.target.classList.add("disabled");
      event.target.setAttribute("disabled", "");
    }   

    renumberNamedElementsInGroupWrapper(event.target.parentNode.parentNode);    
    
  } // End of: function onClickBehaviorForMoveObjectUpButton (event)
  // End of: Define the function that fires when the moveObjectUpButton is pressed.


  // Bind the function above to the onClick event of the moveObjectUpButton.
  document.querySelectorAll('.moveObjectUpButton').forEach(function(currentButton)
  {
    currentButton.addEventListener("click", onClickBehaviorForMoveObjectUpButton);
  });


  // Define the function that fires when the moveObjectDownButton is selected.
  function onClickBehaviorForMoveObjectDownButton (event)  
  {
    // Stop it from redirecting anywhere
    event.preventDefault();

    // Enable the moveObjectDownButton on the object coming up.
    let moveObjectDownButtonOnTheObjectComingUp = event.target.parentNode.nextElementSibling.querySelector(".moveObjectDownButton");
    moveObjectDownButtonOnTheObjectComingUp.classList.remove('disabled');
    moveObjectDownButtonOnTheObjectComingUp.removeAttribute("disabled");

    // Find out if we are on the top
    if(event.target.parentNode === event.target.parentNode.parentNode.querySelector(".elementWrapper:first-child"))
    {
      // The object coming up will not be able to go up anymore.
      // So no need for the moveObjectUpButton. Disable it. 
      let moveObjectUpButtonOnTheObjectComingUp = event.target.parentNode.nextElementSibling.querySelector(".moveObjectUpButton");      
      moveObjectUpButtonOnTheObjectComingUp.classList.add("disabled");
      moveObjectUpButtonOnTheObjectComingUp.setAttribute("disabled", "");
    } 

    // Since we are moving this elementWrapper down we need to be sure the moveObjectUpButton is enabled.
    // Need this in case it was sitting at the top where the up button is disabled.
    // Enable the moveObjectUpButton next to the target down button
    let moveObjectUpButtonNextToTargetButton = event.target.parentNode.querySelector(".moveObjectUpButton")
    moveObjectUpButtonNextToTargetButton.classList.remove('disabled');
    moveObjectUpButtonNextToTargetButton.removeAttribute("disabled");

    // Move this elementWrapper down
    if(event.target.parentNode.nextElementSibling)
    {
      event.target.parentNode.parentNode.insertBefore(event.target.parentNode.nextElementSibling, event.target.parentNode);
    }
  
    // Find out if we are at the bottom
        if(event.target.parentNode === event.target.parentNode.parentNode.querySelector(".elementWrapper:nth-last-child(2)"))    
    {
      // Can't move down anymore than this.
      // Disable the target moveObjectDownButton.
      event.target.classList.add("disabled");
      event.target.setAttribute("disabled", "");
    }   

    renumberNamedElementsInGroupWrapper(event.target.parentNode.parentNode);

  } // End of: function onClickBehaviorForMoveObjectDownButton (event)
  // End of: Define the function that fires when the moveObjectDownButton is pressed.


  // Bind the function above to the onClick event of the moveObjectDownButton.
  document.querySelectorAll('.moveObjectDownButton').forEach(function(currentButton)
  {
    currentButton.addEventListener("click", onClickBehaviorForMoveObjectDownButton);
  });
  // End of: Bind the function above to the onClick event of the moveObjectDownButton.  


  // Define the function that fires when the removeObjectButton is selected.
  function onClickBehaviorForRemoveObjectButton (event)  
  {
    // Stop it from redirecting anywhere
    event.preventDefault();

    // If we are on the top
    if(event.target.parentNode === event.target.parentNode.parentNode.querySelector(".elementWrapper:first-child"))
    {
      // The object coming up will not be able to go up anymore.
      // So no need for the moveObjectUpButton. Disable it. 
      let moveObjectUpButtonOnTheObjectComingUp = event.target.parentNode.nextElementSibling.querySelector(".moveObjectUpButton");      
      moveObjectUpButtonOnTheObjectComingUp.classList.add("disabled");
      moveObjectUpButtonOnTheObjectComingUp.setAttribute("disabled", "");

      // If there are only two left
      if(event.target.parentNode.parentNode.querySelectorAll(".elementWrapper").length === 2)
      {
        // We must never delete the last one
        // So disable the removeObjectButton on the last survivor    
        
        let removeObjectButtonOnTheObjectComingUp = event.target.parentNode.nextElementSibling.querySelector(".removeObjectButton");      
        removeObjectButtonOnTheObjectComingUp.classList.add("disabled");
        removeObjectButtonOnTheObjectComingUp.setAttribute("disabled", "");

      }
    } // End of: If there are only two left
    // End of: If we are on the top

    // If we are on the bottom
    if(event.target.parentNode === event.target.parentNode.parentNode.querySelector(".elementWrapper:nth-last-child(2)"))
    {
      // The object coming down will not be able to go down anymore.
      // So no need for the moveObjectDownButton. Disable it. 
      let moveObjectDownButtonOnTheObjectComingDown = event.target.parentNode.previousElementSibling.querySelector(".moveObjectDownButton");      
      moveObjectDownButtonOnTheObjectComingDown.classList.add("disabled");
      moveObjectDownButtonOnTheObjectComingDown.setAttribute("disabled", "");

      // If there are only two left
      if(event.target.parentNode.parentNode.querySelectorAll(".elementWrapper").length === 2)
      {
        // We must never delete the last one
        // So disable the removeObjectButton on the last survivor    
        
        let removeObjectButtonOnTheObjectComingDown = event.target.parentNode.previousElementSibling.querySelector(".removeObjectButton");      
        removeObjectButtonOnTheObjectComingDown.classList.add("disabled");
        removeObjectButtonOnTheObjectComingDown.setAttribute("disabled", "");

      } // End of: If there are only two left
    } // End of: If we are on the bottom

    let groupWrapper = event.target.parentNode.parentNode;

    // Remove the button's parent node.
    event.target.parentNode.remove()

    renumberNamedElementsInGroupWrapper(groupWrapper);    

  } // End of: function onClickBehaviorForRemoveObjectButton (event){...}
  // End of: Define the function that fires when the removeObjectButton is selected.


  // Bind the function above to the onClick event of the removeObjectButtons.
  document.querySelectorAll('.removeObjectButton').forEach(function(currentButton)
  {
    currentButton.addEventListener("click", onClickBehaviorForRemoveObjectButton);
  });
  // End of: Bind the function above to the onClick event of the removeObjectButtons.


  // Define the function that fires when the addNewObjectButton is selected.
  function onClickBehaviorForAddNewObjectButton (event)  
  {
    // Stop it from redirecting anywhere
    event.preventDefault();

    // Count the element wrappers surrounding the control elements that 
    // exist in this groupWrapper along with this addNew button.
    let elementWrapperCount = event.target.parentNode.querySelectorAll(".elementWrapper").length;

    // Deep clone a new elementWrapper from the last one inside the target's groupWrapper.
    let elmnt = event.target.parentNode.querySelectorAll(".elementWrapper")[elementWrapperCount - 1];
    let cln = elmnt.cloneNode(true);

    // Set all the clone's element values to ""
    cln.querySelectorAll(".resetElement").forEach(function(element){element.value = "";});

    // Create an event listener for the onclick event of the clone's removeObjectButton.
    cln.querySelector(".removeObjectButton").addEventListener("click", onClickBehaviorForRemoveObjectButton);

    // Create an event listener for the onclick event of the clone's moveObjectUpButton.
    cln.querySelector(".moveObjectUpButton").addEventListener("click", onClickBehaviorForMoveObjectUpButton);

    // Create an event listener for the onclick event of the clone's moveObjectDownButton.
    cln.querySelector(".moveObjectDownButton").addEventListener("click", onClickBehaviorForMoveObjectDownButton);

    // Enable the clone's moveObjectUpButton
    cln.querySelector(".moveObjectUpButton").classList.remove('disabled');
    cln.querySelector(".moveObjectUpButton").removeAttribute("disabled");

    // Disable the clone's moveObjectDownButton
    cln.querySelector(".moveObjectDownButton").classList.add("disabled");
    cln.querySelector(".moveObjectDownButton").setAttribute("disabled", "");

    // Enable the clone's removeObjectButton. 
    cln.querySelector(".removeObjectButton").classList.remove('disabled');
    cln.querySelector(".removeObjectButton").removeAttribute("disabled");

    // Disable the very top moveObjectUpButton
    event.target.parentNode.querySelectorAll(".moveObjectUpButton")[0].classList.add("disabled");
    event.target.parentNode.querySelectorAll(".moveObjectUpButton")[0].setAttribute("disabled", "");

    // Enable all but clone's moveObjectDownButton
    event.target.parentNode.querySelectorAll(".moveObjectDownButton").forEach(function(currentButton)
    {
      currentButton.classList.remove('disabled');
      currentButton.removeAttribute("disabled");    
    });

    // Enable all but clone's removeObjectButton
    event.target.parentNode.querySelectorAll(".removeObjectButton").forEach(function(currentButton)
    {
      currentButton.classList.remove('disabled');
      currentButton.removeAttribute("disabled");    
    });

    // Append the clone to the object group in the DOM
    let targetGroupWrapper = event.target.parentNode;
    targetGroupWrapper.insertBefore(cln, targetGroupWrapper.childNodes[targetGroupWrapper.childNodes.length -2]);

    // Renumbering during page load prevents object containers from loading correctly.
    // This is because the forEach loops in the querySelectors at 4eyhkvwtznzs8f9pmy08 
    // require that all classes have the same identifier.
    if(allowRenumbering)
    {
      renumberNamedElementsInGroupWrapper(event.target.parentNode);      
    }

  } // End of: function onClickBehaviorForAddNewObjectButton (event)
  // End of: Define the function that fires when the addNewObjectButton is pressed.


  // Bind the function above to the onClick event of the addNewObjectButtons.
  document.querySelectorAll('.addNewObjectButton').forEach(function(currentButton)
  {
    currentButton.addEventListener("click", onClickBehaviorForAddNewObjectButton);
  });  
  // End of: Bind the function above to the onClick event of the addNewObjectButtons.


  // Get the phone count.
  const phoneAmount = Object.keys(recordObject.phone.properties).length;

  // Clone enough elementWrappers to accommodate every phone.
  for (let loopCount = 0; loopCount < phoneAmount - 1; loopCount++) 
  {
    const addButton = document.querySelectorAll('.addNewObjectButton')[0];
    addButton.click();
  };


  // Get the address count.
  const addressAmount = Object.keys(recordObject.address.properties).length;

  // Clone enough elementWrappers to accommodate every address.
  for (let loopCount = 0; loopCount < addressAmount - 1; loopCount++) 
  {
    const addButton = document.querySelectorAll('.addNewObjectButton')[1];
    addButton.click();
  };

  // Put the data into the forms as values where needed ?????
  // Behaviour from meta.js at 4eyhkvwtznzs8f9pmy08

  document.querySelectorAll(".firstNameInput").forEach(function (element){element.value = recordObject.firstName});
  document.querySelectorAll(".lastNameInput").forEach(function (element){element.value = recordObject.lastName});
  document.querySelectorAll(".emailInput").forEach(function (element){element.value = recordObject.email});

  document.querySelectorAll(".phone_properties_phone0_properties_phoneTypeInput").forEach
  (
    function (element, elementIndex)
    {
      element.value = recordObject.phone.properties["phone" + elementIndex.toString()].properties.phoneType;
    }
  );


  document.querySelectorAll(".phone_properties_phone0_properties_phoneInput").forEach
  (
    function (element, elementIndex)
    {
      element.value = recordObject.phone.properties["phone" + elementIndex.toString()].properties.phone;
    }
  );  


  document.querySelectorAll(".address_properties_address0_properties_addressTypeInput").forEach
  (
    function (element, elementIndex)
    {
      element.value = recordObject.address.properties["address" + elementIndex.toString()].properties.addressType;
    }
  );  


  document.querySelectorAll(".address_properties_address0_properties_streetOneInput").forEach
  (
    function (element, elementIndex)
    {
      element.value = recordObject.address.properties["address" + elementIndex.toString()].properties.streetOne;
    }
  );  


  document.querySelectorAll(".address_properties_address0_properties_streetTwoInput").forEach
  (
    function (element, elementIndex)
    {
      element.value = recordObject.address.properties["address" + elementIndex.toString()].properties.streetTwo;
    }
  );  

  document.querySelectorAll(".address_properties_address0_properties_cityInput").forEach
  (
    function (element, elementIndex)
    {
      element.value = recordObject.address.properties["address" + elementIndex.toString()].properties.city;
    }
  );  

  document.querySelectorAll(".address_properties_address0_properties_stateInput").forEach
  (
    function (element, elementIndex)
    {
      element.value = recordObject.address.properties["address" + elementIndex.toString()].properties.state;
    }
  );  

  document.querySelectorAll(".address_properties_address0_properties_zipInput").forEach
  (
    function (element, elementIndex)
    {
      element.value = recordObject.address.properties["address" + elementIndex.toString()].properties.zip;
    }
  );  


  document.querySelectorAll(".timeStampInput").forEach(function(element){element.value = recordObject.timeStamp});  


  // Now that the page has loaded we can renumber any object containers.
  allowRenumbering = true;  
  document.querySelectorAll(".groupWrapper").forEach(function(currentWrapper){renumberNamedElementsInGroupWrapper(currentWrapper)});


  // Define a function to get the published fields and the timeStamp from the oContactID
  async function runQueryOnoContactId(queryExpression) 
  {
    const res = await fetch('api/oContact' + queryExpression);

    // Verify that we have some sort of 2xx response that we can use
    if (!res.ok) 
    {
        console.log("Error trying to load the oContact record: ");
        // throw res;
    }
    // If no content, immediately resolve, don't try to parse JSON
    if (res.status === 204)
    {
        return [];
    }
    // Get all the text sent by the server as a single string.
    const content = await res.text();

    // Split the content string on each new line character and put the results into an array called lines.
    const lines = content.split("\n");

    // Get rid of the last element in the array. This is just a new line character.
    lines.splice(lines.length -1, 1);

    // Return a new array to the calling function consisting of JSON objects which contain each record sent by the server.
    return lines.map(function(line)
    {
      if(line != "")
      {
        return JSON.parse(line);
      }
    });
  } // End of: async function runQueryOnoContactId(queryExpression){...}
  // End of: Define a function to get the published fields and the timeStamp from the oContactID

}; // End of: app.loadoContactEditPage = function(){...}




// Define a function which renumbers field names in children objects as we create, move, or delete their element wrappers
function renumberNamedElementsInGroupWrapper(groupWrapper)
{
  // Loop through the elementWrappers.
  groupWrapper.querySelectorAll('.elementWrapper').forEach(function(elementWrapper, wrapperIndex)
  {
    // Loop through the form elements inside each elementWrapper.
    elementWrapper.querySelectorAll('.resetElement').forEach(function(fieldElement)
    {

      // Define a function to change the numeral in the name to match it's position in the groupWrapper.
      function increment_last(str) 
      {
        return str.replace(/[0-9]+(?!.*[0-9])/, wrapperIndex);
      }

      // Get the form element's name.
      let previousNameAttribute = fieldElement.getAttribute("name");
      
      // Call the function above to increment the numeral embedded in the name.
      let nextNameAttribute = increment_last(previousNameAttribute);

      // Set the name of the formElement as calculated above.
      fieldElement.setAttribute("name", nextNameAttribute)

      // Get the form element's input class. ?????
      let previousInputClass = fieldElement.classList.item(1);
      
      // Call the function above to increment the numeral embedded in the class identifier.
      let nextInputClass = increment_last(previousInputClass);

      fieldElement.classList.remove(previousInputClass);

      // Set the input class of the formElement as calculated above.
      fieldElement.classList.add(nextInputClass);

    }); // End of: elementWrapper.querySelectorAll('.resetElement').forEach(function(fieldElement){...}
  }); // End of: groupWrapper.querySelectorAll('.elementWrapper').forEach(function(elementWrapper, wrapperIndex)
} // End of: function renumberNamedElementsInGroupWrapper(groupWrapper){...}
// End of: Define a function which renumbers field names in children objects as we create, move, or delete their element wrappers




// Init (bootstrapping)
app.init = function(){

  // Bind all form submissions
  app.bindForms();

  // Load data on page
  app.loadoContactEditPage();
};
// End of: Init (bootstrapping)



// Call the init processes after the window loads.
// This is where it all starts.
window.onload = function(){
  app.init();
};
</script>

