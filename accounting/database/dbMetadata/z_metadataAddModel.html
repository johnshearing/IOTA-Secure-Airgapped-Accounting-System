<!-- This entire file was generated by meta.js at 37bdou8uc4khgjtts5nh -->
<!-- Any changes to this file will be overwritten when the application is regenerated -->
<!-- Make your changes in the generator meta.js or in the data dictionary metadata.json -->
<h1>Create a New Table</h1>
<h2>Enter instructions for creating a new table in the system</h2>

<div class="formWrapper">
  <form id="metadataAdd" action="/api/metadata" method="POST">
    <div class="formError"></div>
    <div class="inputWrapper">
      <div class="inputLabel">Table Name</div>
      <input name="tableName" type="text" placeHolder="Enter a Table Name"/>
    </div>
    <div class="inputWrapper">
      <div class="inputLabel">Directory</div>
      <input name="directory" type="text" placeHolder="Enter a Directory"/>
    </div>
    <div class="inputWrapper">
      <div class="inputLabel">Add Routes</div>
      <select name="addRoutes" type="text" placeHolder="Select Yes or No">
        <option value="" style="display: list-item;">Select Yes or No</option>
        <option value="yes" style="display: list-item;">Yes</option>
        <option value="no" style="display: list-item;">No</option>
      </select>
    </div>
    <div class="inputWrapper">
      <div class="inputLabel">Allow Code Generation</div>
      <select name="allowCodeGeneration" type="text" placeHolder="Select Yes or No">
        <option value="" style="display: list-item;">Select Yes or No</option>
        <option value="yes" style="display: list-item;">Yes</option>
        <option value="no" style="display: list-item;">No</option>
      </select>
    </div>
    <span class="expandControl" style="color:blue;font-weight:bold">&#10515;&nbsp;&nbsp;</span><span class="collapseControl" style="color:blue;font-weight:bold">&#10514;</span>
    <div class="objectLabel">Field Information &#8681;</div>
    <div class="objectWrapper groupWrapper" style="border: 2px solid blue;">
      <div class="objectWrapper elementWrapper" style="border: 2px solid blue;">
        <div class="inputWrapper">
          <div class="inputLabel">Field Name</div>
          <input class="resetElement" name="field_field0_fieldName" type="text" placeHolder="Enter a Field Name"/>
        </div>
        <div class="inputWrapper">
          <div class="inputLabel">Data Type</div>
          <select class="dataTypeSelect resetElement" name="field_field0_dataType">
            <option value="" style="display: list-item;">Select the Data Type</option>
            <option value="string" style="display: list-item;" selected>String</option>
            <option value="object" style="display: list-item;">Object</option>
          </select>
        </div>
        <div class="inputWrapper">
          <div class="inputLabel">Unique</div>
          <select class="resetElement" name="field_field0_unique">
            <option value="" style="display: list-item;">Select if Unique</option>
            <option value="yes" style="display: list-item;">Yes</option>
            <option value="no" style="display: list-item;">No</option>
          </select>
        </div>
        <div class="inputWrapper">
          <div class="inputLabel">Published</div>
          <select class="resetElement" name="field_field0_published">
            <option value="" style="display: list-item;">Select if Published</option>
            <option value="yes" style="display: list-item;">Yes</option>
            <option value="no" style="display: list-item;">No</option>
          </select>
        </div>
        <div class="objectLabel">Default Elements &#8681;</div>
        <div class="objectWrapper groupWrapper" style="border: 2px solid red;">
          <div class="objectWrapper elementWrapper" style="border: 2px solid red;">
            <div class="inputWrapper">
              <div class="inputLabel">Element Name</div>
              <input class="resetElement" name="field_field0_defaultElement_defaultElement0_elementName" type="text"/>
            </div>
            <div class="inputWrapper">
              <div class="inputLabel">Label Text</div>
              <input class="resetElement" name="field_field0_defaultElement_defaultElement0_labelText" type="text"/>
            </div>
            <div class="inputWrapper">
              <div class="inputLabel">Element Type</div>
              <select class="resetElement" name="field_field0_defaultElement_defaultElement0_elementType">
                <option value="" style="display: list-item;">Select the Element Type</option>
                <option value="input" style="display: list-item;">Input</option>
                <option value="select" style="display: list-item;">Select</option>
              </select>
            </div>
            <div class="objectLabel">Attributes &#8681;</div>
            <div class="objectWrapper groupWrapper" style="border: 2px solid green;">
              <div class="objectWrapper elementWrapper" style="border: 2px solid green;">
                <div class="inputWrapper">
                  <div class="inputLabel">Attribute Name</div>
                  <input class="resetElement" name="field_field0_defaultElement_defaultElement0_attribute_attribute0_attributeName" type="text" list="inputAttributes" domainFor="attributes"/>
                </div>
                <div class="inputWrapper">
                  <div class="inputLabel">Attribute Value</div>
                  <input class="resetElement" name="field_field0_defaultElement_defaultElement0_attribute_attribute0_attributeValue" type="text" rangeFor="attributes"/>
                </div>
                <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
                <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
                <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
              </div>
              <button type="button" class="addNewObjectButton" style="background-color: green;">Add New Attribute</button>
            </div>
            <div class="objectLabel">Validations &#8681;</div>
            <div class="objectWrapper groupWrapper" style="border: 2px solid green;">
              <div class="objectWrapper elementWrapper" style="border: 2px solid green;">
                <div class="objectLabel">Default Validation &#8681;</div>
                <div class="objectWrapper groupWrapper" style="border: 2px solid blue;">
                  <div class="objectWrapper elementWrapper" style="border: 2px solid blue;">
                    <div class="inputWrapper">
                      <div class="inputLabel">Default Validation Name</div>
                      <input class="resetElement" name="field_field0_defaultElement_defaultElement0_validation_validation0_default_default0_defaultValidationName" type="text" list="validation"/>
                    </div>
                    <div class="inputWrapper">
                      <div class="inputLabel">Default Validation Value</div>
                      <input class="resetElement" name="field_field0_defaultElement_defaultElement0_validation_validation0_default_default0_defaultValidationValue" type="text"/>
                    </div>
                    <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
                    <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
                    <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
                  </div>
                  <button type="button" class="addNewObjectButton" style="background-color: blue;">Add New Default</button>
                </div>
                <div class="objectLabel">Post Validation &#8681;</div>
                <div class="objectWrapper groupWrapper" style="border: 2px solid blue;">
                  <div class="objectWrapper elementWrapper" style="border: 2px solid blue;">
                    <div class="inputWrapper">
                      <div class="inputLabel">Post Validation Name</div>
                      <input class="resetElement" name="field_field0_defaultElement_defaultElement0_validation_validation0_post_post0_postValidationName" type="text" list="validation"/>
                    </div>
                    <div class="inputWrapper">
                      <div class="inputLabel">Post Validation Value</div>
                      <input class="resetElement" name="field_field0_defaultElement_defaultElement0_validation_validation0_post_post0_postValidationValue" type="text"/>
                    </div>
                    <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
                    <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
                    <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
                  </div>
                  <button type="button" class="addNewObjectButton" style="background-color: blue;">Add New Post</button>
                </div>
                <div class="objectLabel">Put Validation &#8681;</div>
                <div class="objectWrapper groupWrapper" style="border: 2px solid blue;">
                  <div class="objectWrapper elementWrapper" style="border: 2px solid blue;">
                    <div class="inputWrapper">
                      <div class="inputLabel">Put Validation Name</div>
                      <input class="resetElement" name="field_field0_defaultElement_defaultElement0_validation_validation0_put_put0_putValidationName" type="text" list="validation"/>
                    </div>
                    <div class="inputWrapper">
                      <div class="inputLabel">Put Validation Value</div>
                      <input class="resetElement" name="field_field0_defaultElement_defaultElement0_validation_validation0_put_put0_putValidationValue" type="text"/>
                    </div>
                    <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
                    <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
                    <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
                  </div>
                  <button type="button" class="addNewObjectButton" style="background-color: blue;">Add New Put</button>
                </div>
                <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
                <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
                <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
              </div>
              <button type="button" class="addNewObjectButton" style="background-color: green;">Add New Validation</button>
            </div>
            <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
            <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
            <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
          </div>
          <button type="button" class="addNewObjectButton" style="background-color: red;">Add New DefaultElement</button>
        </div>
        <div class="objectLabel">Calculations &#8681;</div>
        <div class="objectWrapper groupWrapper" style="border: 2px solid red;">
          <div class="objectWrapper elementWrapper" style="border: 2px solid red;">
            <div class="inputWrapper">
              <div class="inputLabel">Calculation Name</div>
              <input class="resetElement" name="field_field0_calculation_calculation0_calculationName" type="text" list="calculation"/>
            </div>
            <div class="inputWrapper">
              <div class="inputLabel">Calculation Value</div>
              <input class="resetElement" name="field_field0_calculation_calculation0_calculationValue" type="text"/>
            </div>
            <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
            <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
            <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
          </div>
          <button type="button" class="addNewObjectButton" style="background-color: red;">Add New Calculation</button>
        </div>
        <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
        <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
        <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
      </div>
      <button type="button" class="addNewObjectButton" style="background-color: blue;">Add New Field</button>
    </div>
    <div class="objectLabel">WebPage Information &#8681;</div>
    <div class="objectWrapper groupWrapper" style="border: 2px solid blue;">
      <div class="objectWrapper elementWrapper" style="border: 2px solid blue;">
        <div class="inputWrapper">
          <div class="inputLabel">WebPage Type</div>
          <input class="resetElement" name="webPage_webPage0_webPageType" type="text" list="webPageTypes" domainFor="formTypes"/>
        </div>
        <div class="inputWrapper">
          <div class="inputLabel">WebPage Heading</div>
          <input class="resetElement" name="webPage_webPage0_webPageHeading" type="text" placeHolder="Enter a WebPage Heading"/>
        </div>
        <div class="objectLabel">Forms &#8681;</div>
        <div class="objectWrapper groupWrapper" style="border: 2px solid red;">
          <div class="objectWrapper elementWrapper" style="border: 2px solid red;">
            <div class="inputWrapper">
              <div class="inputLabel">Form Type</div>
              <input class="resetElement" name="webPage_webPage0_form_form0_formType" type="text" rangeFor="formTypes"/>
            </div>
            <div class="inputWrapper">
              <div class="inputLabel">Form Heading</div>
              <input class="resetElement" name="webPage_webPage0_form_form0_formHeading" type="text"/>
            </div>
            <div class="inputWrapper">
              <div class="inputLabel">Submit Button Text</div>
              <input class="resetElement" name="webPage_webPage0_form_form0_submitButtonText" type="text"/>
            </div>
            <div class="objectLabel">Form Elements &#8681;</div>
            <div class="objectWrapper groupWrapper" style="border: 2px solid green;">
              <div class="objectWrapper elementWrapper" style="border: 2px solid green;">
                <div class="inputWrapper">
                  <div class="inputLabel">Form Element Name</div>
                  <input class="resetElement" name="webPage_webPage0_form_form0_formElement_formElement0_formElementName" type="text"/>
                </div>
                <div class="inputWrapper">
                  <div class="inputLabel">Form Element Label Text</div>
                  <input class="resetElement" name="webPage_webPage0_form_form0_formElement_formElement0_formElementLabelText" type="text"/>
                </div>
                <div class="objectLabel">Attributes &#8681;</div>
                <div class="objectWrapper groupWrapper" style="border: 2px solid blue;">
                  <div class="objectWrapper elementWrapper" style="border: 2px solid blue;">
                    <div class="inputWrapper">
                      <div class="inputLabel">Attribute Name</div>
                      <input class="resetElement" name="webPage_webPage0_form_form0_formElement_formElement0_attribute_attribute0_feAttributeName" type="text" list="inputAttributes" domainFor="attributes"/>
                    </div>
                    <div class="inputWrapper">
                      <div class="inputLabel">Attribute Value</div>
                      <input class="resetElement" name="webPage_webPage0_form_form0_formElement_formElement0_attribute_attribute0_feAttributeValue" type="text" rangeFor="attributes"/>
                    </div>
                    <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
                    <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
                    <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
                  </div>
                  <button type="button" class="addNewObjectButton" style="background-color: blue;">Add New Attribute</button>
                </div>
                <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
                <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
                <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
              </div>
              <button type="button" class="addNewObjectButton" style="background-color: green;">Add New FormElement</button>
            </div>
            <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
            <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
            <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
          </div>
          <button type="button" class="addNewObjectButton" style="background-color: red;">Add New Form</button>
        </div>
        <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
        <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
        <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
      </div>
      <button type="button" class="addNewObjectButton" style="background-color: blue;">Add New WebPage</button>
    </div>
    <div class="inputWrapper ctaWrapper smallTopMargin">
      <button type="submit" class="cta green">Create Table</button>
    </div>
  </form>
</div>
<datalist id="inputAttributes">
  <option value="autocomplete"/>
  <option value="autofocus"/>
  <option value="checked"/>
  <option value="disabled"/>
  <option value="height"/>
  <option value="list"/>
  <option value="max"/>
  <option value="min"/>
  <option value="multiple"/>
  <option value="pattern"/>
  <option value="placeholder"/>
  <option value="readonly"/>
  <option value="size"/>
  <option value="src"/>
  <option value="type"/>
  <option value="value"/>
</datalist>
<datalist id="autocomplete">
  <option value="on"/>
  <option value="off"/>
</datalist>
<datalist id="type">
  <option value="button"/>
  <option value="checkbox"/>
  <option value="color"/>
  <option value="date"/>
  <option value="datetime-local"/>
  <option value="email"/>
  <option value="file"/>
  <option value="hidden"/>
  <option value="image"/>
  <option value="month"/>
  <option value="number"/>
  <option value="password"/>
  <option value="radio"/>
  <option value="range"/>
  <option value="reset"/>
  <option value="search"/>
  <option value="submit"/>
  <option value="tel"/>
  <option value="text"/>
  <option value="time"/>
  <option value="url"/>
  <option value="week"/>
</datalist>
<datalist id="validation">
  <option value="passIfNotEmpty"/>
  <option value="passIfString"/>
  <option value="passIfString&NotEmptyThenTrim"/>
  <option value="passIfHasAmpersand"/>
  <option value="passMenuItemsOnly"/>
</datalist>
<datalist id="calculation">
  <option value="postHandlerPreprocessing"/>
  <option value="putHandlerPreprocessing"/>
</datalist>
<datalist id="webPageTypes">
  <option value="addPage"/>
  <option value="listPage"/>
  <option value="editPage"/>
</datalist>
<datalist id="addPage">
  <option value="addForm"/>
</datalist>
<datalist id="listPage">
  <option value="listForm"/>
</datalist>
<datalist id="editPage">
  <option value="editForm"/>
  <option value="deleteForm"/>
</datalist>


<script type="text/objectTemplate">
<div class="objectLabel">Field Information &#8681;</div>
<div class="objectWrapper groupWrapper" style="border: 2px solid blue;">
  <div class="objectWrapper elementWrapper" style="border: 2px solid blue;">
    <div class="inputWrapper">
      <div class="inputLabel">Field Name</div>
      <input class="resetElement" name="field_field0_fieldName" type="text" placeHolder="Enter a Field Name"/>
    </div>
    <div class="inputWrapper">
      <div class="inputLabel">Data Type</div>
      <select class="dataTypeSelect resetElement" name="field_field0_dataType">
        <option value="" style="display: list-item;">Select the Data Type</option>
        <option value="string" style="display: list-item;" selected>String</option>
        <option value="object" style="display: list-item;">Object</option>
      </select>
    </div>
    <div class="inputWrapper">
      <div class="inputLabel">Unique</div>
      <select class="resetElement" name="field_field0_unique">
        <option value="" style="display: list-item;">Select if Unique</option>
        <option value="yes" style="display: list-item;">Yes</option>
        <option value="no" style="display: list-item;">No</option>
      </select>
    </div>
    <div class="inputWrapper">
      <div class="inputLabel">Published</div>
      <select class="resetElement" name="field_field0_published">
        <option value="" style="display: list-item;">Select if Published</option>
        <option value="yes" style="display: list-item;">Yes</option>
        <option value="no" style="display: list-item;">No</option>
      </select>
    </div>
    <div class="objectLabel">Default Elements &#8681;</div>
    <div class="objectWrapper groupWrapper" style="border: 2px solid red;">
      <div class="objectWrapper elementWrapper" style="border: 2px solid red;">
        <div class="inputWrapper">
          <div class="inputLabel">Element Name</div>
          <input class="resetElement" name="field_field0_defaultElement_defaultElement0_elementName" type="text"/>
        </div>
        <div class="inputWrapper">
          <div class="inputLabel">Label Text</div>
          <input class="resetElement" name="field_field0_defaultElement_defaultElement0_labelText" type="text"/>
        </div>
        <div class="inputWrapper">
          <div class="inputLabel">Element Type</div>
          <select class="resetElement" name="field_field0_defaultElement_defaultElement0_elementType">
            <option value="" style="display: list-item;">Select the Element Type</option>
            <option value="input" style="display: list-item;">Input</option>
            <option value="select" style="display: list-item;">Select</option>
          </select>
        </div>
        <div class="objectLabel">Attributes &#8681;</div>
        <div class="objectWrapper groupWrapper" style="border: 2px solid green;">
          <div class="objectWrapper elementWrapper" style="border: 2px solid green;">
            <div class="inputWrapper">
              <div class="inputLabel">Attribute Name</div>
              <input class="resetElement" name="field_field0_defaultElement_defaultElement0_attribute_attribute0_attributeName" type="text" list="inputAttributes" domainFor="attributes"/>
            </div>
            <div class="inputWrapper">
              <div class="inputLabel">Attribute Value</div>
              <input class="resetElement" name="field_field0_defaultElement_defaultElement0_attribute_attribute0_attributeValue" type="text" rangeFor="attributes"/>
            </div>
            <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
            <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
            <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
          </div>
          <button type="button" class="addNewObjectButton" style="background-color: green;">Add New Attribute</button>
        </div>
        <div class="objectLabel">Validations &#8681;</div>
        <div class="objectWrapper groupWrapper" style="border: 2px solid green;">
          <div class="objectWrapper elementWrapper" style="border: 2px solid green;">
            <div class="objectLabel">Default Validation &#8681;</div>
            <div class="objectWrapper groupWrapper" style="border: 2px solid blue;">
              <div class="objectWrapper elementWrapper" style="border: 2px solid blue;">
                <div class="inputWrapper">
                  <div class="inputLabel">Default Validation Name</div>
                  <input class="resetElement" name="field_field0_defaultElement_defaultElement0_validation_validation0_default_default0_defaultValidationName" type="text" list="validation"/>
                </div>
                <div class="inputWrapper">
                  <div class="inputLabel">Default Validation Value</div>
                  <input class="resetElement" name="field_field0_defaultElement_defaultElement0_validation_validation0_default_default0_defaultValidationValue" type="text"/>
                </div>
                <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
                <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
                <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
              </div>
              <button type="button" class="addNewObjectButton" style="background-color: blue;">Add New Default</button>
            </div>
            <div class="objectLabel">Post Validation &#8681;</div>
            <div class="objectWrapper groupWrapper" style="border: 2px solid blue;">
              <div class="objectWrapper elementWrapper" style="border: 2px solid blue;">
                <div class="inputWrapper">
                  <div class="inputLabel">Post Validation Name</div>
                  <input class="resetElement" name="field_field0_defaultElement_defaultElement0_validation_validation0_post_post0_postValidationName" type="text" list="validation"/>
                </div>
                <div class="inputWrapper">
                  <div class="inputLabel">Post Validation Value</div>
                  <input class="resetElement" name="field_field0_defaultElement_defaultElement0_validation_validation0_post_post0_postValidationValue" type="text"/>
                </div>
                <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
                <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
                <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
              </div>
              <button type="button" class="addNewObjectButton" style="background-color: blue;">Add New Post</button>
            </div>
            <div class="objectLabel">Put Validation &#8681;</div>
            <div class="objectWrapper groupWrapper" style="border: 2px solid blue;">
              <div class="objectWrapper elementWrapper" style="border: 2px solid blue;">
                <div class="inputWrapper">
                  <div class="inputLabel">Put Validation Name</div>
                  <input class="resetElement" name="field_field0_defaultElement_defaultElement0_validation_validation0_put_put0_putValidationName" type="text" list="validation"/>
                </div>
                <div class="inputWrapper">
                  <div class="inputLabel">Put Validation Value</div>
                  <input class="resetElement" name="field_field0_defaultElement_defaultElement0_validation_validation0_put_put0_putValidationValue" type="text"/>
                </div>
                <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
                <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
                <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
              </div>
              <button type="button" class="addNewObjectButton" style="background-color: blue;">Add New Put</button>
            </div>
            <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
            <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
            <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
          </div>
          <button type="button" class="addNewObjectButton" style="background-color: green;">Add New Validation</button>
        </div>
        <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
        <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
        <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
      </div>
      <button type="button" class="addNewObjectButton" style="background-color: red;">Add New DefaultElement</button>
    </div>
    <div class="objectLabel">Calculations &#8681;</div>
    <div class="objectWrapper groupWrapper" style="border: 2px solid red;">
      <div class="objectWrapper elementWrapper" style="border: 2px solid red;">
        <div class="inputWrapper">
          <div class="inputLabel">Calculation Name</div>
          <input class="resetElement" name="field_field0_calculation_calculation0_calculationName" type="text" list="calculation"/>
        </div>
        <div class="inputWrapper">
          <div class="inputLabel">Calculation Value</div>
          <input class="resetElement" name="field_field0_calculation_calculation0_calculationValue" type="text"/>
        </div>
        <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
        <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
        <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
      </div>
      <button type="button" class="addNewObjectButton" style="background-color: red;">Add New Calculation</button>
    </div>
    <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
    <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
    <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
  </div>
  <button type="button" class="addNewObjectButton" style="background-color: blue;">Add New Field</button>
</div>        
</script>


<script type="text/stringTemplate">
  <div class="objectLabel">Default Elements &#8681;</div>
  <div class="objectWrapper groupWrapper" style="border: 2px solid red;">
    <div class="objectWrapper elementWrapper" style="border: 2px solid red;">
      <div class="inputWrapper">
        <div class="inputLabel">Element Name</div>
        <input class="resetElement" name="field_field0_defaultElement_defaultElement0_elementName" type="text"/>
      </div>
      <div class="inputWrapper">
        <div class="inputLabel">Label Text</div>
        <input class="resetElement" name="field_field0_defaultElement_defaultElement0_labelText" type="text"/>
      </div>
      <div class="inputWrapper">
        <div class="inputLabel">Element Type</div>
        <select class="resetElement" name="field_field0_defaultElement_defaultElement0_elementType">
          <option value="" style="display: list-item;">Select the Element Type</option>
          <option value="input" style="display: list-item;">Input</option>
          <option value="select" style="display: list-item;">Select</option>
        </select>
      </div>
      <div class="objectLabel">Attributes &#8681;</div>
      <div class="objectWrapper groupWrapper" style="border: 2px solid green;">
        <div class="objectWrapper elementWrapper" style="border: 2px solid green;">
          <div class="inputWrapper">
            <div class="inputLabel">Attribute Name</div>
            <input class="resetElement" name="field_field0_defaultElement_defaultElement0_attribute_attribute0_attributeName" type="text" list="inputAttributes" domainFor="attributes"/>
          </div>
          <div class="inputWrapper">
            <div class="inputLabel">Attribute Value</div>
            <input class="resetElement" name="field_field0_defaultElement_defaultElement0_attribute_attribute0_attributeValue" type="text" rangeFor="attributes"/>
          </div>
          <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
          <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
          <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
        </div>
        <button type="button" class="addNewObjectButton" style="background-color: green;">Add New Attribute</button>
      </div>
      <div class="objectLabel">Validations &#8681;</div>
      <div class="objectWrapper groupWrapper" style="border: 2px solid green;">
        <div class="objectWrapper elementWrapper" style="border: 2px solid green;">
          <div class="objectLabel">Default Validation &#8681;</div>
          <div class="objectWrapper groupWrapper" style="border: 2px solid blue;">
            <div class="objectWrapper elementWrapper" style="border: 2px solid blue;">
              <div class="inputWrapper">
                <div class="inputLabel">Default Validation Name</div>
                <input class="resetElement" name="field_field0_defaultElement_defaultElement0_validation_validation0_default_default0_defaultValidationName" type="text" list="validation"/>
              </div>
              <div class="inputWrapper">
                <div class="inputLabel">Default Validation Value</div>
                <input class="resetElement" name="field_field0_defaultElement_defaultElement0_validation_validation0_default_default0_defaultValidationValue" type="text"/>
              </div>
              <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
              <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
              <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
            </div>
            <button type="button" class="addNewObjectButton" style="background-color: blue;">Add New Default</button>
          </div>
          <div class="objectLabel">Post Validation &#8681;</div>
          <div class="objectWrapper groupWrapper" style="border: 2px solid blue;">
            <div class="objectWrapper elementWrapper" style="border: 2px solid blue;">
              <div class="inputWrapper">
                <div class="inputLabel">Post Validation Name</div>
                <input class="resetElement" name="field_field0_defaultElement_defaultElement0_validation_validation0_post_post0_postValidationName" type="text" list="validation"/>
              </div>
              <div class="inputWrapper">
                <div class="inputLabel">Post Validation Value</div>
                <input class="resetElement" name="field_field0_defaultElement_defaultElement0_validation_validation0_post_post0_postValidationValue" type="text"/>
              </div>
              <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
              <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
              <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
            </div>
            <button type="button" class="addNewObjectButton" style="background-color: blue;">Add New Post</button>
          </div>
          <div class="objectLabel">Put Validation &#8681;</div>
          <div class="objectWrapper groupWrapper" style="border: 2px solid blue;">
            <div class="objectWrapper elementWrapper" style="border: 2px solid blue;">
              <div class="inputWrapper">
                <div class="inputLabel">Put Validation Name</div>
                <input class="resetElement" name="field_field0_defaultElement_defaultElement0_validation_validation0_put_put0_putValidationName" type="text" list="validation"/>
              </div>
              <div class="inputWrapper">
                <div class="inputLabel">Put Validation Value</div>
                <input class="resetElement" name="field_field0_defaultElement_defaultElement0_validation_validation0_put_put0_putValidationValue" type="text"/>
              </div>
              <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
              <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
              <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
            </div>
            <button type="button" class="addNewObjectButton" style="background-color: blue;">Add New Put</button>
          </div>
          <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
          <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
          <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
        </div>
        <button type="button" class="addNewObjectButton" style="background-color: green;">Add New Validation</button>
      </div>
      <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
      <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
      <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
    </div>
    <button type="button" class="addNewObjectButton" style="background-color: red;">Add New DefaultElement</button>
  </div>
  <div class="objectLabel">Calculations &#8681;</div>
  <div class="objectWrapper groupWrapper" style="border: 2px solid red;">
    <div class="objectWrapper elementWrapper" style="border: 2px solid red;">
      <div class="inputWrapper">
        <div class="inputLabel">Calculation Name</div>
        <input class="resetElement" name="field_field0_calculation_calculation0_calculationName" type="text" list="calculation"/>
      </div>
      <div class="inputWrapper">
        <div class="inputLabel">Calculation Value</div>
        <input class="resetElement" name="field_field0_calculation_calculation0_calculationValue" type="text"/>
      </div>
      <button type="button" class="disabled controlObjectButton moveObjectUpButton blue" disabled>Move Up</button>
      <button type="button" class="disabled controlObjectButton moveObjectDownButton blue" disabled>Move Down</button>
      <button type="button" class="disabled controlObjectButton removeObjectButton red" disabled>Remove</button>
    </div>
    <button type="button" class="addNewObjectButton" style="background-color: red;">Add New Calculation</button>
  </div>
</script>


<script>
/*
 * Frontend Logic for application
 *
 */

"use strict";

// Container for frontend application
var app = {};


// AJAX Client (for RESTful API)
// Create an empty object to contain the client.
app.client = {}




// Define interface function for making API calls.
app.client.request = function(headers,path,method,queryStringObject,payload,callback)
{
  // Set defaults
  headers = typeof(headers) == 'object' && headers !== null ? headers : {};
  path = typeof(path) == 'string' ? path : '/';
  method = typeof(method) == 'string' && ['POST','GET','PUT','DELETE'].indexOf(method.toUpperCase()) > -1 ? method.toUpperCase() : 'GET';
  queryStringObject = typeof(queryStringObject) == 'object' && queryStringObject !== null ? queryStringObject : {};
  payload = typeof(payload) == 'object' && payload !== null ? payload : {};
  callback = typeof(callback) == 'function' ? callback : false;

  // For each query string parameter sent, add it to the path
  var requestUrl = path+'?';
  var counter = 0;
  for(var queryKey in queryStringObject)
  {
    if(queryStringObject.hasOwnProperty(queryKey))
    {
      counter++;

      // If at least one query string parameter has already been added, preprend new ones with an ampersand
      if(counter > 1)
      {
        requestUrl+='&';
      }

      // Add the key and value
      requestUrl+=queryKey+'='+queryStringObject[queryKey];
    }
  }

  // Form the http request as a JSON type
  var xhr = new XMLHttpRequest();
  xhr.open(method, requestUrl, true);
  xhr.setRequestHeader("Content-type", "application/json");

  // For each header sent, add it to the request
  for(var headerKey in headers)
  {
     if(headers.hasOwnProperty(headerKey))
     {
       xhr.setRequestHeader(headerKey, headers[headerKey]);
     }
  }

  // If there is a current session token set, add that as a header
  // if(app.config.sessionToken)
  // {
  //   xhr.setRequestHeader("token", app.config.sessionToken.id);
  // }

  // When the request comes back, handle the response
  xhr.onreadystatechange = function()
  {
      if(xhr.readyState == XMLHttpRequest.DONE) 
      {
        var statusCode = xhr.status;
        var responseReturned = xhr.responseText;

        // Callback if requested
        if(callback)
        {
          try
          {
            var parsedResponse = JSON.parse(responseReturned);
            callback(statusCode,parsedResponse);
          } 
          catch(e)
          {
            callback(statusCode,false);
          }

        }
      }
  }

  // Send the payload as JSON
  var payloadString = JSON.stringify(payload);
  xhr.send(payloadString);

}; // End of: app.client.request = function(headers,path,method,queryStringObject,payload,callback){...}
// End of: Interface for making API calls




// Add a listener to the submit event of all forms in the DOM and bind the anonymous 
// function declared below to the listener using addEventListener.
// bindForms is called from app.init when the webpage is loaded but the anonymous 
// function declared using addEventListener only runs when the form is submitted.
// The function takes the submit event object (e) as the argument.
app.bindForms = function()
{
  // If the DOM contains the CSS selector "form"
  if(document.querySelector("form"))
  {

    // Create an interface to manipulate all the forms in the DOM.
    var allForms = document.querySelectorAll("form");

    // Add a listener to the submit event of every form in the DOM and bind the anonymous function declared here.
    for(var i = 0; i < allForms.length; i++)
    {
      // The following is what runs when the user submits the form.
      allForms[i].addEventListener("submit", function(e)
      {
        // Stop it from submitting
        e.preventDefault();

        // The key word "this" below refers to the html (more accurately the DOM) of the form being submitted.
        // The formId from the html (DOM) is used when loading the form with data.
        var formId = this.id;
        //path and method will determine which api handler will get called.
        var path = this.action;
        var method = this.method.toUpperCase();

        // Hide the error message (if it's currently shown due to a previous error)
        document.querySelector("#"+formId+" .formError").style.display = 'none';

        // Hide the success message (if it's currently shown)
        if(document.querySelector("#"+formId+" .formSuccess"))
        {
          document.querySelector("#"+formId+" .formSuccess").style.display = 'none';
        }


        // Create an empty payload object.
        var payload = {};

        // this.elements is an object containing the inputs and buttons defined in the html of the form being submitted.
        var elements = this.elements;

        // Load the payload object with the names and values of the elements in the form being submitted. 
        for(var i = 0; i < elements.length; i++)
        {
          if(elements[i].type !== 'submit')
          {
            // Determine class of element and set value accordingly.
            var classOfElement = typeof(elements[i].classList.value) == 'string' && elements[i].classList.value.length > 0 ? elements[i].classList.value : '';
            var valueOfElement = elements[i].type == 'checkbox' && classOfElement.indexOf('multiselect') == -1 ? elements[i].checked : classOfElement.indexOf('intval') == -1 ? elements[i].value : parseInt(elements[i].value);
            var elementIsChecked = elements[i].checked;

            // Override the method of the form if the input's name is _method
            var nameOfElement = elements[i].name;

            if(nameOfElement == '_method')
            {
              method = valueOfElement;
            } 
            else // nameOfElement was something other than '_method'
            {
              // Create a payload field named "method" if the elements name is actually httpmethod
              if(nameOfElement == 'httpmethod')
              {
                nameOfElement = 'method';
              }

              // Create an payload field named "id" if the elements name is actually uid
              if(nameOfElement == 'uid')
              {
                nameOfElement = 'id';
              }

              // If the element has the class "multiselect" add its value(s) as array elements
              if(classOfElement.indexOf('multiselect') > -1)
              {
                if(elementIsChecked)
                {
                  payload[nameOfElement] = typeof(payload[nameOfElement]) == 'object' && payload[nameOfElement] instanceof Array ? payload[nameOfElement] : [];
                  payload[nameOfElement].push(valueOfElement);
                }
              } 
              else // element was not of the class multiselect
              {
                payload[nameOfElement] = valueOfElement;
              }
            } // End of: nameOfElement was something other than '_method'
          } // End of: if(elements[i].type !== 'submit'){...}
        } // End of: for(var 1...
        // End of: Load the payload object with the names and values of the elements in the form.


        // Create and empty queryString Object. Never used but needs to be there.
        var queryStringObject = {};          


        // Call the API
        app.client.request(undefined,path,method,queryStringObject,payload,function(statusCode,responsePayload)
        {
          // Display an error on the form if needed
          if(statusCode !== 200)
          {

            if(statusCode == 403)
            {
               // log the user out
               // app.logUserOut();
            } 
            else // Status code was not 200 nor was it 403
            {
              // Try to get the error from the api, or set a default error message
              var error = typeof(responsePayload.Error) == 'string' ? responsePayload.Error : 'An error has occured, please try again';

              // Set the formError field with the error text
              document.querySelector("#"+formId+" .formError").innerHTML = error;

              // Show (unhide) the form error field on the form
              document.querySelector("#"+formId+" .formError").style.display = 'block';
            }
          } 
          else // The submit was successful and we got a response back from the server.
          {
            // Send to form response processor
            app.formResponseProcessor(formId,payload,responsePayload);
          }

        }); // End of: app.client.request(undefined,path,method,queryStringObject,payload,function(statusCode,responsePayload){...}
      }); // End of: allForms[i].addEventListener("submit", function(e){...} What runs when users submits the form.
    } // End of: for(var i = 0; i < allForms.length; i++){...}
  } // End of: if(document.querySelector("form")){...}
}; // End of: app.bindForms = function(){...}
// End of: Bind the anonymous function defined above to the submit event of any forms in the DOM.




// Form submit post processor
// This is the last function called from the anonymous function defined in app.bindForms which 
// executes on a form's submit event.
// So this function defines what happens after a form has been sucessfully submitted.
app.formResponseProcessor = function(formId,requestPayload,responsePayload)
{
  // Navigate to the list page for this table.
  window.location = formId.slice(0, -3) + '/list';  

}; // End of: app.formResponseProcessor = function(formId,requestPayload,responsePayload){...}
// End of: Form submit post processor - processing after a sucessful form submit.




// Bind controls to behaviors when the page loads.
// Behavior from meta.js at i0hrsc6x02jooocdy71o
app.loadoContactAddPage = function()
{

  // Define the function that fires when we click on a the global expand control.
  // This function expands all nested data on the webpage.
  function onClickBehaviorForExpandControl (event)  
  {
    // Stop it from redirecting anywhere
    event.preventDefault();

    document.querySelectorAll(".objectLabel").forEach(function(currentLabel)
    {
      let controlledElement = currentLabel.nextElementSibling;

      controlledElement.style.display = "block";
      currentLabel.innerHTML = currentLabel.innerHTML.replace("⇨", "⇩");
    });
  } // End of: function onChangeBehaviorForAttributeName (event)
  // End of: Define the function that fires when we click on a the global expand control.

  // Bind the function above to the onClick event of the label elements.
  document.querySelectorAll(".expandControl").forEach(function(currentControl)
  {
    currentControl.addEventListener("click", onClickBehaviorForExpandControl, true);
  });


  // Define the function that fires when we click on a the global collapse control.
  // This function collapses all nested data on the webpage.
  function onClickBehaviorForCollapseControl (event)  
  {
    // Stop it from redirecting anywhere
    event.preventDefault();

    document.querySelectorAll(".objectLabel").forEach(function(currentLabel)
    {
      let controlledElement = currentLabel.nextElementSibling;

      controlledElement.style.display = "none";
      currentLabel.innerHTML = currentLabel.innerHTML.replace("⇩", "⇨")
    });
  } // End of: function onClickBehaviorForCollapseControl (event)
  // End of: Define the function that fires when we click on a the global collapse control.

  // Bind the function above to the onClick event of the label elements.
  document.querySelectorAll(".collapseControl").forEach(function(currentControl)
  {
    currentControl.addEventListener("click", onClickBehaviorForCollapseControl, true);
  });


  // Define the function that fires when we click on a label.
  // This function shows or hides data associated with the target label.
  function onClickBehaviorForLabelElement (event)  
  {
    // Stop it from redirecting anywhere
    event.preventDefault();

    let labelElement = event.target;
    let controlledElement = labelElement.nextElementSibling;

    if (controlledElement.style.display === "none") 
    {
      controlledElement.style.display = "block";
      labelElement.innerHTML = labelElement.innerHTML.replace("⇨", "⇩");
    } 
    else 
    {
      controlledElement.style.display = "none";
      labelElement.innerHTML = labelElement.innerHTML.replace("⇩", "⇨");
    }

  } // End of: function onClickBehaviorForLabelElement (event)
  // End of: Define the function that fires when we click on a label.

  // Bind the function above to the onClick event of the label elements.
  document.querySelectorAll(".objectLabel").forEach(function(currentLabel)
  {
    currentLabel.addEventListener("click", onClickBehaviorForLabelElement, true);
  });


  // Define the function that fires when a domain element is selected.
  // The following function makes datalists context sensitive.
  // When a change is made on the domain select or input element
  // the range element is matched with the appropriate datalist.
  // This requires that the domainFor and rangeFor attributes have the same value.
  function onChangeBehaviorForDomainElement (event)  
  {
    // Stop it from redirecting anywhere
    event.preventDefault();

    let domainElement = event.target;
    let rangeIdentifier = domainElement.getAttribute("domainFor");

    let rangeCandidates = domainElement.parentNode.parentNode.querySelectorAll("input");

    for (let currentElement of rangeCandidates)
    {
      if(currentElement.getAttribute("rangeFor") === rangeIdentifier)
      {
        currentElement.setAttribute("list", event.target.value);
      }
    };
  } // End of: function onChangeBehaviorForAttributeName (event)
  // Define the function that fires when an attribute is selected.

  // Bind the function above to the onChange event of the input element.
  document.querySelectorAll("input").forEach(function(currentInput)
  {
    if(currentInput.getAttribute('domainFor'))
    {
      currentInput.addEventListener("change", onChangeBehaviorForDomainElement, true);
    }
  });

  // Define the function that fires when the moveObjectUpButton is selected.
  function onClickBehaviorForMoveObjectUpButton (event)  
  {
    // Stop it from redirecting anywhere
    event.preventDefault();

    // Enable the moveObjectUpButton on the object coming down.
    let moveObjectUpButtonOnTheObjectComingDown = event.target.parentNode.previousElementSibling.querySelectorAll(".moveObjectUpButton")[event.target.parentNode.previousElementSibling.querySelectorAll(".moveObjectUpButton").length - 1];
    moveObjectUpButtonOnTheObjectComingDown.classList.remove('disabled');
    moveObjectUpButtonOnTheObjectComingDown.removeAttribute("disabled");

    // Find out if we are at the bottom
    if(!event.target.parentNode.nextElementSibling.classList.contains("elementWrapper"))
    {
      // The object coming down will not be able to go down anymore.
      // So no need for the moveObjectDownButton. Disable it.
      let moveObjectDownButtonOnTheObjectComingDown = event.target.parentNode.previousElementSibling.querySelectorAll(".moveObjectDownButton")[event.target.parentNode.previousElementSibling.querySelectorAll(".moveObjectDownButton").length - 1];
      moveObjectDownButtonOnTheObjectComingDown.classList.add("disabled");
      moveObjectDownButtonOnTheObjectComingDown.setAttribute("disabled", "");
    }  

    // Enable the moveObjectDownButton next to the target button.
    // Since we are moving this elementWrapper up we need to be sure the moveObjectDownButton is enabled.
    // Need this in case it was sitting on the bottom where the down button is disabled.
    let moveObjectDownButtonNextToTargetButton = event.target.nextElementSibling
    moveObjectDownButtonNextToTargetButton.classList.remove('disabled');
    moveObjectDownButtonNextToTargetButton.removeAttribute("disabled");
    
    // Move the object up
    if(event.target.parentNode.previousElementSibling)
    {
      event.target.parentNode.parentNode.insertBefore(event.target.parentNode, event.target.parentNode.previousElementSibling);
    }
     
    // Find out if we are at the top
    if(event.target.parentNode === event.target.parentNode.parentNode.firstElementChild)
    {
      // Can't move up anymore than this.
      // Disable the target moveObjectUpButton
      event.target.classList.add("disabled");
      event.target.setAttribute("disabled", "");
    }   

    renumberNamedElementsInGroupWrapper(event.target.parentNode.parentNode);    
    
  } // End of: function onClickBehaviorForMoveObjectUpButton (event)
  // End of: Define the function that fires when the moveObjectUpButton is pressed.


  // Bind the function above to the onClick event of the moveObjectUpButton.
  document.querySelectorAll('.moveObjectUpButton').forEach(function(currentButton)
  {
    currentButton.addEventListener("click", onClickBehaviorForMoveObjectUpButton);
  });


  // Define the function that fires when the moveObjectDownButton is selected.
  function onClickBehaviorForMoveObjectDownButton (event)  
  {
    // Stop it from redirecting anywhere
    event.preventDefault();

    // Enable the moveObjectDownButton on the object coming up.
    let moveObjectDownButtonOnTheObjectComingUp = event.target.parentNode.nextElementSibling.querySelectorAll(".moveObjectDownButton")[event.target.parentNode.nextElementSibling.querySelectorAll(".moveObjectDownButton").length - 1];    
    moveObjectDownButtonOnTheObjectComingUp.classList.remove('disabled');
    moveObjectDownButtonOnTheObjectComingUp.removeAttribute("disabled");

    // Find out if we are on the top
    if(!event.target.parentNode.previousElementSibling)
    {
      // The object coming up will not be able to go up anymore.
      // So no need for the moveObjectUpButton. Disable it. 
      let moveObjectUpButtonOnTheObjectComingUp = event.target.parentNode.nextElementSibling.querySelectorAll(".moveObjectUpButton")[event.target.parentNode.nextElementSibling.querySelectorAll(".moveObjectUpButton").length - 1];
      moveObjectUpButtonOnTheObjectComingUp.classList.add("disabled");
      moveObjectUpButtonOnTheObjectComingUp.setAttribute("disabled", "");
    } 

    // Since we are moving this elementWrapper down we need to be sure the moveObjectUpButton is enabled. 
    // Need this in case it was sitting at the top where the up button is disabled.
    // Enable the moveObjectUpButton next to the target down button
    let moveObjectUpButtonNextToTargetButton = event.target.previousElementSibling    
    moveObjectUpButtonNextToTargetButton.classList.remove('disabled');
    moveObjectUpButtonNextToTargetButton.removeAttribute("disabled");

    // Move this elementWrapper down
    if(event.target.parentNode.nextElementSibling)
    {
      event.target.parentNode.parentNode.insertBefore(event.target.parentNode.nextElementSibling, event.target.parentNode);
    }
  
    // Find out if we are at the bottom
    if(!event.target.parentNode.nextElementSibling.classList.contains("elementWrapper"))     
    {
      // Can't move down anymore than this.
      // Disable the target moveObjectDownButton.
      event.target.classList.add("disabled");
      event.target.setAttribute("disabled", "");
    }   

    renumberNamedElementsInGroupWrapper(event.target.parentNode.parentNode);

  } // End of: function onClickBehaviorForMoveObjectDownButton (event)
  // End of: Define the function that fires when the moveObjectDownButton is pressed.


  // Bind the function above to the onClick event of the moveObjectDownButton.
  document.querySelectorAll('.moveObjectDownButton').forEach(function(currentButton)
  {
    currentButton.addEventListener("click", onClickBehaviorForMoveObjectDownButton);
  });
  // End of: Bind the function above to the onClick event of the moveObjectDownButton.  


  // Define the function that fires when the removeObjectButton is selected.
  function onClickBehaviorForRemoveObjectButton (event)  
  {
    // Stop it from redirecting anywhere
    event.preventDefault();

    // If we are on the top
    // if(event.target.parentNode === event.target.parentNode.parentNode.querySelector(".elementWrapper:first-child"))
    if(!event.target.parentNode.previousElementSibling)    
    {
      // The object coming up will not be able to go up anymore.
      // So no need for the moveObjectUpButton. Disable it. 
      let moveObjectUpButtonOnTheObjectComingUp = event.target.parentNode.nextElementSibling.querySelectorAll(".moveObjectUpButton")[event.target.parentNode.nextElementSibling.querySelectorAll(".moveObjectUpButton").length - 1];      
      moveObjectUpButtonOnTheObjectComingUp.classList.add("disabled");
      moveObjectUpButtonOnTheObjectComingUp.setAttribute("disabled", "");

      // If there are only two left
      if(event.target.parentNode.parentNode.childElementCount === 3)      
      {
        // We must never delete the last one
        // So disable the removeObjectButton on the last survivor    
        let removeObjectButtonOnTheObjectComingUp = event.target.parentNode.nextElementSibling.querySelectorAll(".removeObjectButton")[event.target.parentNode.nextElementSibling.querySelectorAll(".removeObjectButton").length - 1];           
        removeObjectButtonOnTheObjectComingUp.classList.add("disabled");
        removeObjectButtonOnTheObjectComingUp.setAttribute("disabled", "");
      }
    } // End of: If there are only two left
    // End of: If we are on the top

    // If we are on the bottom
    if(!event.target.parentNode.nextElementSibling.classList.contains("elementWrapper"))    
    {
      // The object coming down will not be able to go down anymore.
      // So no need for the moveObjectDownButton. Disable it. 
      let moveObjectDownButtonOnTheObjectComingDown = event.target.parentNode.previousElementSibling.querySelectorAll(".moveObjectDownButton")[event.target.parentNode.previousElementSibling.querySelectorAll(".moveObjectDownButton").length - 1];     
      moveObjectDownButtonOnTheObjectComingDown.classList.add("disabled");
      moveObjectDownButtonOnTheObjectComingDown.setAttribute("disabled", "");

      // If there are only two left
      if(event.target.parentNode.parentNode.childElementCount === 3)
      {
        // We must never delete the last one
        // So disable the removeObjectButton on the last survivor
        let removeObjectButtonOnTheObjectComingDown = event.target.parentNode.previousElementSibling.querySelectorAll(".removeObjectButton")[event.target.parentNode.previousElementSibling.querySelectorAll(".removeObjectButton").length - 1];        
        removeObjectButtonOnTheObjectComingDown.classList.add("disabled");
        removeObjectButtonOnTheObjectComingDown.setAttribute("disabled", "");
      } // End of: If there are only two left 
    } // End of: If we are on the bottom

    let groupWrapper = event.target.parentNode.parentNode;

    // Remove the button's parent node.
    event.target.parentNode.remove()

    renumberNamedElementsInGroupWrapper(groupWrapper);    

  } // End of: function onClickBehaviorForRemoveObjectButton (event){...}
  // End of: Define the function that fires when the removeObjectButton is selected.


  // Bind the function above to the onClick event of the removeObjectButtons.
  document.querySelectorAll('.removeObjectButton').forEach(function(currentButton)
  {
    currentButton.addEventListener("click", onClickBehaviorForRemoveObjectButton);
  });
  // End of: Bind the function above to the onClick event of the removeObjectButtons.


  // Define the function that fires when the dataTypeSelect element is changed.
  // This function changes the form depending on what type of data you are trying to model.
  function onChangeBehaviorForDataTypeSelectElement (event)
  {
    // Stop it from redirecting anywhere
    event.preventDefault();
    // Create a handle for the structureTemplate here so all functions below will have access to it.
    // There are two templates. 
    // One for defining fields which are strings and the other for defining fields which are objects.
    // These templates are in script tags between the HTML and the JavaScript.

    // Declare here so it will stay in scope throughout the function.
    let structureTemplate;

    // Apply the template selected by the user.
    if(event.target.value === "string")
    {
      structureTemplate = document.querySelector('[type="text/stringTemplate"]');
    }
    else // Object was selected
    {
      structureTemplate = document.querySelector('[type="text/objectTemplate"]');
    }

    let templateClone = structureTemplate.cloneNode(true);
    let templateHTMl = templateClone.textContent;

    // Create a handle for the container which holds the items to be removed.
    let templateTarget = event.target.parentNode.parentNode;

    // Create a handle for the top item to be removed
    let topElementToBeRemoved = templateTarget.querySelector(".objectLabel")

    // Start removing items starting from the bottom of the nodelist working upward.
    while(true)
    {
      if(templateTarget.lastChild === topElementToBeRemoved)
      {
        templateTarget.removeChild(templateTarget.lastChild);
        break;
      }
      else // Continue looping
      {
        templateTarget.removeChild(templateTarget.lastChild);
      }
    }

    // To restore values overwritten when loading template.
    let valueArray = [];

    // Save the values
    templateTarget.querySelectorAll(".resetElement").forEach(function(currentElement)
    {
      valueArray.push(currentElement.value);
    });

    // load the template into the DOM
    templateTarget.innerHTML = templateTarget.innerHTML + templateHTMl;

    // Create handles for the new elements so that we can load the data back in.
    // Also used to modify the element names so the renumbering will work.    
    let newNodeList = templateTarget.querySelectorAll(".resetElement");

    // Here is where we load the data back in.
    for ( let i = 0; i < valueArray.length; i++ ) 
    {
      newNodeList[i].value = valueArray[i];
    }

    // Start of: Find out what nestLevel we are at.
    // Create a handle for the highest groupWrapper in the hierarchy.
    let topGroupWrapper = templateTarget.closest("form > .groupWrapper");

    // Used in the following while loop.
    let levelCounter = 1;
    let currentWrapper = templateTarget;

    // Climb to the top, counting nestLevels.
    while(true)
    {
      currentWrapper = currentWrapper.parentElement;

      let currentClassList = currentWrapper.classList

      if(currentWrapper === topGroupWrapper) //If we are at the top.
      {             
        break;
      }
      else if(currentWrapper.classList.contains("groupWrapper"))
      {
        levelCounter = levelCounter + 1;       
      }
    }

    // End of: Find out what nestLevel we are at.

    // Start of: Prepending "field_field0_" in the right amount depending on nestlevel to fieldNames of all elements which came the template.
    // We have to do this or the renumbering function will not work.

    // We are starting from the bottom and working our way up.
    // This gives the index of the last node in the list.
    let downCounter = newNodeList.length - 1;

    // This tells us at what element to stop adding to the names.
    // It's the "published" select control.
    // This control and all above where not added from the template.
    // They were already there.
    let lastElement = templateTarget.querySelectorAll("select")[2];

    while(true) //Loop through the elements changing the names as we go.
    {
      if(newNodeList[downCounter] === lastElement)
      {
        break;
      }

      newNodeList[downCounter].name = "field_field0_".repeat(levelCounter) + newNodeList[downCounter].name;

      downCounter = downCounter -1;
    }

    // End of: Prepending "field_field0_" in the right amount depending on nestlevel to fieldNames of all elements which came the template.

    // Bind this function to the onChange event of the dataTypeSelect element just created.
    templateTarget.querySelectorAll('.dataTypeSelect').forEach(function(currentSelect)
    {
      currentSelect.addEventListener("change", onChangeBehaviorForDataTypeSelectElement);
    });  

    // Create an event listener for the onClick event of the clone's 
    // label elements which expand and collapse objects.    
    templateTarget.querySelectorAll(".objectLabel").forEach(function(currentLabel)
    {
      currentLabel.addEventListener("click", onClickBehaviorForLabelElement, true);
    });

    // Create an event listener for the onChange event of the clone's 
    // input elements which have the domainFor attribute.
    templateTarget.querySelectorAll("input").forEach(function(currentInput)
    {
      if(currentInput.getAttribute('domainFor'))
      {
        currentInput.addEventListener("change", onChangeBehaviorForDomainElement, true);
      }
    });

    // Create an event listener for the onclick event of the clone's removeObjectButtons.
    templateTarget.querySelectorAll(".removeObjectButton").forEach(function(removeObjectButton)
    {
      removeObjectButton.addEventListener("click", onClickBehaviorForRemoveObjectButton);
    });
    
    // Create an event listener for the onclick event of the clone's moveObjectUpButtons.
    templateTarget.querySelectorAll(".moveObjectUpButton").forEach(function(moveObjectUpButton)
    {
      moveObjectUpButton.addEventListener("click", onClickBehaviorForMoveObjectUpButton);
    });    
    
    // Create an event listener for the onclick event of the clone's moveObjectDownButton.
    templateTarget.querySelectorAll(".moveObjectDownButton").forEach(function(moveObjectDownButton)
    {
      moveObjectDownButton.addEventListener("click", onClickBehaviorForMoveObjectDownButton);
    });

    // Create an event listener for the onclick event of the clone's addNewObjectButtons.
    templateTarget.querySelectorAll('.addNewObjectButton').forEach(function(addNewObjectButton)
    {
      addNewObjectButton.addEventListener("click", onClickBehaviorForAddNewObjectButton);
    });

    // Enable the clone's moveObjectUpButtons
    templateTarget.querySelectorAll(".moveObjectUpButton").forEach(function(moveObjectUpButton)
    {
      if(moveObjectUpButton.parentNode === templateTarget)
      {
        moveObjectUpButton.classList.remove('disabled');
        moveObjectUpButton.removeAttribute("disabled");
      }
    });

    // Disable the clone's moveObjectDownButton
    templateTarget.querySelectorAll(".moveObjectDownButton").forEach(function(moveObjectDownButton)
    {
        moveObjectDownButton.classList.add("disabled");
        moveObjectDownButton.setAttribute("disabled", "");
    }); 

    // Disable all removeObjectButtons on the clone.
    // This is to disable buttons on any children.
    // In the next step after this, the removeObjectButton is enabled at the top level.
    templateTarget.querySelectorAll(".removeObjectButton").forEach(function(removeObjectButton)
    {
      removeObjectButton.classList.add("disabled");
      removeObjectButton.setAttribute("disabled", "");
    }); 

    // Enable the clone's top level removeObjectButton
    templateTarget.querySelectorAll(".removeObjectButton").forEach(function(removeObjectButton)
    {
      if(removeObjectButton.parentNode === templateTarget)
      {
        removeObjectButton.classList.remove('disabled');
        removeObjectButton.removeAttribute("disabled");
      }
    }); 

    // Disable the very top moveObjectUpButton
    event.target.parentNode.querySelectorAll(".moveObjectUpButton").forEach(function(moveObjectUpButton)
    {
      if(moveObjectUpButton.parentNode === event.target.parentNode)
      {
        moveObjectUpButton.classList.add("disabled");
        moveObjectUpButton.setAttribute("disabled", "");
      }
    }); 

    // Enable all but clone's moveObjectDownButton
    event.target.parentNode.querySelectorAll(".moveObjectDownButton").forEach(function(moveObjectDownButton)
    {
      if(moveObjectDownButton.parentNode.parentNode === event.target.parentNode)
      {
        moveObjectDownButton.classList.remove('disabled');
        moveObjectDownButton.removeAttribute("disabled");
      }  
    });

    // Enable all but clone's removeObjectButton
    event.target.parentNode.querySelectorAll(".removeObjectButton").forEach(function(removeObjectButton)
    {
      if(removeObjectButton.parentNode.parentNode === event.target.parentNode)
      {
        removeObjectButton.classList.remove('disabled');
        removeObjectButton.removeAttribute("disabled");
      }   
    });

    renumberNamedElementsInGroupWrapper(templateTarget.parentNode);

  } // End of: function onClickBehaviorForDataTypeSelectElement (event)
  // End of: Define the function that fires when the dataTypeSelect element is selected.


  // Bind the function above to the onChange event of the dataTypeSelect element.
  document.querySelectorAll('.dataTypeSelect').forEach(function(currentSelect)
  {
    currentSelect.addEventListener("change", onChangeBehaviorForDataTypeSelectElement);
  });  
  // End of: Bind the function above to the onChange event of the dataTypeSelect element.


  // Define the function that fires when the addNewObjectButton is selected.
  function onClickBehaviorForAddNewObjectButton (event)  
  {
    // Stop it from redirecting anywhere
    event.preventDefault();

    // Initialize a pointer to the elementWrapper we will clone.
    // We are cloning the last elementWrapper the groupWrapper.
    let lastElementWrapper;

    event.target.parentNode.querySelectorAll(".elementWrapper").forEach(function(elementWrapper)
    {
      if(elementWrapper.parentNode === event.target.parentNode)
      {
        lastElementWrapper = elementWrapper;
      }
    });

    // Here we deep clone the last elementWrapper.
    let cln = lastElementWrapper.cloneNode(true);

    // Remove all the but the first of any elementWappers from the clone groupWrapper
    cln.querySelectorAll(".elementWrapper:not(:first-child)").forEach(function(elementWrapper)
    {
      elementWrapper.remove()
    });

    // Set all the clone's element values to ""
    cln.querySelectorAll(".resetElement").forEach(function(element){element.value = "";});

    // Bind the function above to the onClick event of the clone's label elements.
    cln.querySelectorAll(".objectLabel").forEach(function(currentLabel)
    {
      currentLabel.addEventListener("click", onClickBehaviorForLabelElement, true);
    });

    // Create an event listener for the onChange event of the clone's 
    // input elements which have the domainFor attribute.
    cln.querySelectorAll("input").forEach(function(currentInput)
    {
      if(currentInput.getAttribute('domainFor'))
      {
        currentInput.addEventListener("change", onChangeBehaviorForDomainElement, true);
      }
    });

    // Create an event listener for the onclick event of the clone's removeObjectButtons.
    cln.querySelectorAll(".removeObjectButton").forEach(function(removeObjectButton)
    {
      removeObjectButton.addEventListener("click", onClickBehaviorForRemoveObjectButton);
    });
    
    // Create an event listener for the onclick event of the clone's moveObjectUpButtons.
    cln.querySelectorAll(".moveObjectUpButton").forEach(function(moveObjectUpButton)
    {
      moveObjectUpButton.addEventListener("click", onClickBehaviorForMoveObjectUpButton);
    });    
    
    // Create an event listener for the onclick event of the clone's moveObjectDownButton.
    cln.querySelectorAll(".moveObjectDownButton").forEach(function(moveObjectDownButton)
    {
      moveObjectDownButton.addEventListener("click", onClickBehaviorForMoveObjectDownButton);
    });

    // Create an event listener for the onChange event of the clone's dataTypeSelect.
    cln.querySelectorAll('.dataTypeSelect').forEach(function(currentSelect)
    {
      currentSelect.addEventListener("change", onChangeBehaviorForDataTypeSelectElement);
    }); 

    // Create an event listener for the onclick event of the clone's addNewObjectButtons.
    cln.querySelectorAll('.addNewObjectButton').forEach(function(addNewObjectButton)
    {
      addNewObjectButton.addEventListener("click", onClickBehaviorForAddNewObjectButton);
    });

    // Enable the clone's moveObjectUpButtons
    cln.querySelectorAll(".moveObjectUpButton").forEach(function(moveObjectUpButton)
    {
      if(moveObjectUpButton.parentNode === cln)
      {
        moveObjectUpButton.classList.remove('disabled');
        moveObjectUpButton.removeAttribute("disabled");
      }
    });

    // Disable the clone's moveObjectDownButton
    cln.querySelectorAll(".moveObjectDownButton").forEach(function(moveObjectDownButton)
    {
        moveObjectDownButton.classList.add("disabled");
        moveObjectDownButton.setAttribute("disabled", "");
    }); 

    // Disable all removeObjectButtons on the clone.
    // This is to disable buttons on any children.
    // In the next step after this, the removeObjectButton is enabled at the top level.
    cln.querySelectorAll(".removeObjectButton").forEach(function(removeObjectButton)
    {
      removeObjectButton.classList.add("disabled");
      removeObjectButton.setAttribute("disabled", "");
    }); 


    // Enable the clone's top level removeObjectButton
    cln.querySelectorAll(".removeObjectButton").forEach(function(removeObjectButton)
    {
      if(removeObjectButton.parentNode === cln)
      {
        removeObjectButton.classList.remove('disabled');
        removeObjectButton.removeAttribute("disabled");
      }
    }); 

    // Disable the very top moveObjectUpButton
    event.target.parentNode.querySelectorAll(".moveObjectUpButton").forEach(function(moveObjectUpButton)
    {
      if(moveObjectUpButton.parentNode === event.target.parentNode)
      {
        moveObjectUpButton.classList.add("disabled");
        moveObjectUpButton.setAttribute("disabled", "");
      }
    }); 

    // Enable all but clone's moveObjectDownButton
    event.target.parentNode.querySelectorAll(".moveObjectDownButton").forEach(function(moveObjectDownButton)
    {
      if(moveObjectDownButton.parentNode.parentNode === event.target.parentNode)
      {
        moveObjectDownButton.classList.remove('disabled');
        moveObjectDownButton.removeAttribute("disabled");
      }  
    });

    // Enable all but clone's removeObjectButton
    event.target.parentNode.querySelectorAll(".removeObjectButton").forEach(function(removeObjectButton)
    {
      if(removeObjectButton.parentNode.parentNode === event.target.parentNode)
      {
        removeObjectButton.classList.remove('disabled');
        removeObjectButton.removeAttribute("disabled");  
      }   
    });

    // Append the clone to the object group in the DOM
    let targetGroupWrapper = event.target.parentNode;
    targetGroupWrapper.insertBefore(cln, targetGroupWrapper.childNodes[targetGroupWrapper.childNodes.length -2]);

    renumberNamedElementsInGroupWrapper(event.target.parentNode);

  } // End of: function onClickBehaviorForAddNewObjectButton (event)
  // End of: Define the function that fires when the addNewObjectButton is pressed.


  // Bind the function above to the onClick event of the addNewObjectButtons.
  document.querySelectorAll('.addNewObjectButton').forEach(function(currentButton)
  {
    currentButton.addEventListener("click", onClickBehaviorForAddNewObjectButton);
  });  
  // End of: Bind the function above to the onClick event of the addNewObjectButtons.

}; // End of: app.loadoContactAddPage = function(){...}




// Define a function which renumbers field names in children objects as we create, move, or delete their element wrappers
function renumberNamedElementsInGroupWrapper(groupWrapper)
{
  let testCounter = 0 //Debug

  // Used to determine if we are changing levels of hierarchy in the DOM
  // We haven't looked at an elementWrapper yet so it's undefined.
  let previousElementWrapper = undefined;

  // Marks that we have dropped into an elementWrapper and pushed a reference to the 
  // previousElementWrapper onto the ancestorWrappers array along with an index element 
  // showing for which child elementWrapper we are currently numbering elements. The index
  // will always start at zero when pushed onto the ancestorWrappers array. That is because 
  // we always start numbering elements in the first child wrapper at the current level and
  // the index is zero based.
  let pushed = false;

  // Prevents incrementing the counter element in ancestorWrappers array more than once for each loop through the elementWrapper.
  // Marks that we have moved to the next sibling element wrapper.
  let incremented = false;

  // Set when returning the incremented value of the latest ancestorWrapper element to zero.
  // Marks that we are working in an entirely new groupWrapper which is the next sibling of the previous 
  // group wrapper at the current level and another child of the of the latest ancestorWrapper 
  let zeroed = false;

  // The length of ancestorWrappers array indicates which number in the name string gets replaced with the numeric value in the array.
  // Example fieldName: field_field0_defaultElement_defaultElement0_elementName  
  // For example: the zero in field0 gets replaced or the zero in defaultElement0 gets replaced.
  // If ancestorWrappers.length = 1 we put the numeric value in the array in the place of the zero in field0
  // A length of two in ancestorWrappers indicates we put the numeric value in the array in the place of the zero in defaultElement0
  let ancestorWrappers = [["previousElementWrappers_PushedHere", 0]];

  // Facilitates climbing back up the DOM hierarchy without losing history
  let ancestorStack = [];

  // Start at the highest groupWrapper in the hierarchy defined by the groupWrapper that was passed into the function.
  groupWrapper = groupWrapper.closest("form > .groupWrapper");

  // Loop through each elementWrapper.
  groupWrapper.querySelectorAll('.elementWrapper').forEach(function(elementWrapper, wrapperIndex)
  {
    // Used in the following while loop.
    let levelCounter = 0;
    let currentWrapper = elementWrapper.parentElement;

    // Climb to the top, counting nestLevels.
    while(currentWrapper != groupWrapper)
    {
      currentWrapper = currentWrapper.parentElement;

      let currentClassList = currentWrapper.classList

      if(currentWrapper === groupWrapper) //If we are at the top.
      {
        levelCounter = levelCounter + 1; 
        break;
      }
      else if(currentWrapper.classList.contains("groupWrapper"))
      {
        levelCounter = levelCounter + 1;       
      }
    }

    // debugger;
    // let currentAddButton = currentWrapper.querySelector("button:last-child");

    // Border color alternates with nest level. Blue, Red, Green, Blue ...
    // The following is just a ternary if-else statement. 
    // Notice both the elementWrapper and corresponding groupWrapper and addButton are being colored with one command.
    elementWrapper.style.borderColor = elementWrapper.parentElement.style.borderColor = currentAddButton.style.backgroundColor =
    levelCounter % 3 === 0 ? "blue" :
    levelCounter % 3 === 1 ? "red" :      
    levelCounter % 3 === 2 ? "green" : 
    "blue";

 
    // Loop through the form elements inside each elementWrapper.
    elementWrapper.querySelectorAll('.resetElement').forEach(function(fieldElement)
    {
      let elementColor = fieldElement.style.backgroundColor; //Debug
      fieldElement.style.backgroundColor = "blue"; //Debug

      // Start of: Set the amount of elements in ancestorWrappers to show the which number in the 
      // element name is to be changed (the nest level) and set the index element to show which sibling 
      // wrapper the current element is in. This will be the value of the number changed. 
      // Also set the flags which show where we are and what we did to this element.

      // If we are inside the elementWrapper for which we were just numbering elements.
      //    prevents error           if current wrapper is inside the previous
      if(previousElementWrapper && previousElementWrapper.contains(elementWrapper))
      {
        // We just jumped down a level in the DOM
        // The length of this array tells us how many wrappers suround this element - How deep
        // Or which number in the element name is to be replaced with the numeric value in the array.
        // The numeric value in the array tells us the replacement value.

        // Only push once
        if(pushed === false)
        {
          ancestorWrappers.push([previousElementWrapper, 0]);
          pushed = true;
        }

      }
      else // current wrapper is not inside the previous
      {
        // find out what level we are on
        while (true)
        {
          // If we are at the top level...
          if(ancestorWrappers.length === 1 && !previousElementWrapper)
          {
            break; // Don't do anything to the ancestorWrappers array.
          }
          // Else If the current wrapper is inside the last ancestorWrapper. 
          // So we are working with a new elementWrapper at the same level
          // inside the last ancestorWrapper in the ancestorWrappers array.
          else if(ancestorWrappers.length > 1 && ancestorWrappers[ancestorWrappers.length - 1][0].contains(elementWrapper))
          {
            if // If these are siblings which track the same data - phone numbers for example, then increment counter,
            ( 
              elementWrapper.parentNode === previousElementWrapper.parentNode
              || (ancestorStack[ancestorStack.length - 1] && elementWrapper.previousElementSibling === ancestorStack[ancestorStack.length - 1][0])
            )
            {
              if
              (
                incremented === false // If this is the very first element in the elementWrapper...
                && pushed === false   // and if we are not working with the very first elementWrapper in this groupWrapper. 
              )
              {
                // increment the count
                ancestorWrappers[ancestorWrappers.length - 1][1]++;
                incremented = true;
              }
            }
            // Else: This elementWrapper is at the same nest level as previousElementWrapper but is not a sibling.
            // So different elements are being numbered as when previous.
            else 
            {
              // Need to set the index element in the ancestorWrapper array to zero to start numbering at the beginning.
              if
              (zeroed === false) // If this is NOT the very first element in the elementWrapper... 
              {
                // Zero the count
                ancestorWrappers[ancestorWrappers.length - 1][1] = 0;
                zeroed = true;
              }
            }

            break;
          }
          else // the current wrapper is not inside the last ancestorWrapper
          {
            if(ancestorWrappers.length > 1) // if we are not at the top.
            {

              // Remember where we have been.
              ancestorStack.push(ancestorWrappers[ancestorWrappers.length - 1]);


              // Remove the last element and check if the next wrapper up contains the current wrapper.
              ancestorWrappers.pop();

            }
            else // we are back at the top level.
            {
              // We are working with a new elementWrapper at the top level.
              // So increment the numeric value held in the only element of the ancestorWrappers array.
              if(!incremented)
              {
                ancestorWrappers[ancestorWrappers.length - 1][1]++;
                incremented = true;
              }

              break;   
            } // End of: Else - we are back at the top level
          } // End of: Else - the current wrapper is not inside the last ancestorWrapper
        } // End of: while (true)
      } // End of: Else - the current wrapper is not inside the previous

      // End of: Set the amount of elements in ancestorWrappers to show...

      // Start of: Build the form element's name using info in the ancestorWrappers array.

      let fieldNameAttribute = fieldElement.getAttribute("name");
      
      // Search for the nth occurance of a number according to ancestorWrappers.length
      // A length of one indicates that we search for the first number in the name string.
      // A length of two indicates that we search for the second number in the name string.

      // Starting out with an empty string in the reduce function below.
      let initialValue = "";

      // Counts how many times we encounter a number as we run the reduce function below.
      let encountersWithNumbers = 0;

      // Spliting the name string of the current element on the underscore.
      // This makes it easy to find and replace numbers in the string.
      const nameAttributeArray = fieldNameAttribute.split("_")

      // Running the reduce function on every element in the nameAttributeArray
      let nextNameAttribute = nameAttributeArray.reduce
      (
        // This is the callback function that reduce runs on every element in the nameAttributeArray
        function (accumulator, currentSplitElement, currentSplitElementIndex) 
        {
          // Check for a number in the currentSplitElement.
          if(hasANumber(currentSplitElement))
          {
            // Note that we countered a number in the currentSplitElement.
            encountersWithNumbers = encountersWithNumbers + 1

            // If this is the place in the form element's name that we need to insert a number showing position in the DOM...
            if(encountersWithNumbers === ancestorWrappers.length)
            {
              // Insert numbers in the form element's name string to show it's position within the DOM
              // This information is needed in order to write a well formed object to the JSON database.
              //                                                       search for numbers      replace with numbers denoting postion
              accumulator = accumulator +  currentSplitElement.replace(/[0-9]+(?!.*[0-9])/, ancestorWrappers[ancestorWrappers.length - 1][1].toString());

              // Put a dash at the end of the element if it is not the last one.
              if(currentSplitElementIndex < nameAttributeArray.length -1){accumulator = accumulator + "_"};

              return accumulator
            }
            else // There is a number here but we don't want to change it now.
            {
              accumulator = accumulator +  currentSplitElement;

              // Put a dash at the end of the element if it is not the last one.
              if(currentSplitElementIndex < nameAttributeArray.length -1){accumulator = accumulator + "_"};

              return accumulator 
            }

          } // End of: if(helpers.hasANumber(currentSplitElement)){...}
          else // There is no number in the currentSplitElement
          {
            accumulator = accumulator +  currentSplitElement;

            // Put a dash at the end of the element if it is not the last one.
            if(currentSplitElementIndex < nameAttributeArray.length -1){accumulator = accumulator + "_"};

            return accumulator            
          }
        } // End of: function (accumulator, currentSplitElement){...}
        , initialValue // This was an empty string passed in to the reduce function to get things started.
      ); // End of: let nextNameAttribute = nameAttributeArray.reduce(function(){do stuff})

      testCounter = testCounter + 1; //Debug
        
      // Set the name of the formElement as calculated above.
      fieldElement.setAttribute("name", nextNameAttribute)

      fieldElement.style.backgroundColor  = elementColor //Debug

      // End of: Build the form element's name using info in the ancestorWrappers array.


    }); // End of: elementWrapper.querySelectorAll('.resetElement').forEach(function(fieldElement){...}
    // End of: Loop through the form elements inside each elementWrapper.

    previousElementWrapper = elementWrapper;
    ancestorStack = [];
    pushed = false;
    incremented = false;
    zeroed = false;
    
  }); // End of: groupWrapper.querySelectorAll('.elementWrapper').forEach(function(elementWrapper, wrapperIndex)  
} // End of: function renumberNamedElementsInGroupWrapper(groupWrapper){...}
// End of: Define a function which renumbers field names in children objects as we create, move, or delete their element wrappers




// Define a function to check if a string has a number.
function hasANumber(checkString) 
{ 
  let str = String(checkString); 
  
  // Loop through each character of the string.
  for( let i = 0; i < str.length; i++) 
  {
    // If a number is found...
    if(!isNaN(str.charAt(i))) 
    { 
      return true;  
    } 
  } 
  return false; 
}; // End of: Define a function to check if a string has a number.




// Init (bootstrapping)
app.init = function()
{
  // Bind all form submissions
  app.bindForms();

  // Load data on page
  app.loadoContactAddPage();  
};
// End of: Init (bootstrapping)




// Call the init processes after the window loads.
// This is where it all starts.
window.onload = function(){
  app.init();
};

</script>


